[["index.html", "PLS-SEM FEF model exploration and iterations 1 Introduction", " PLS-SEM FEF model exploration and iterations Lauren Kremer 2024-10-27 1 Introduction This book records the workflow that was used for the FEF DOC poster presented at AGU 2024 description: This book describes the workflow of the PLS FEF DOC analysis "],["about.html", "1.1 About", " 1.1 About This book currently documents the development of the PLS-SEM model used to identify a paths of variable influence in our watersheds. This analysis can provide insights into the direct and indirect influences within our system. By estimating path coefficients and measuring the strength and direction of relationships, PLS-SEM models help infer the structural connections among ‘latent variables’, guiding our understanding of complex causal mechanisms within the system. While PLS-SEM doesn’t prove causation, it suggests plausible paths of influence within the system. PLS-SEM connects observed variables to their underlying concepts (latent variables). It combines factor analysis (which reduces reducing a large number of variables into a smaller set of factors, like PCA) with regression. However, unlike traditional regression, which focuses on directly observed variables, PLS-SEM aims to maximize the explained variance in the dependent variables and handles complex, indirect relationships and interactions in the system by evaluating two models at once. The measurement model evaluates relationships between our observed variables and underlying concepts (latent variables). For example, in our dataset, we might consider different measures of a latent variable ‘topography’ as watershed aspect, slope, elevation and indices derived from those measurements like the ‘total wetness index’ (indicators). We can simultaneously determine the relationships among our ‘indicators’ and between indicators and our latent variables while also evaluating the structural model, which looks for relationships between the latent variables. It is robust with non-normal data and ‘small’ samples. It can be used for both exploratory and confirmatory analysis. Here is a simple 2-min video: "],["usage.html", "1.2 Usage", " 1.2 Usage Addition of precipitation and runoff: - This section will grow to include all data management files if Python can be included Correlations plots: data exploration: - Includes the results of PARAFAC analysis. Reviews correlations among compound measures and fluorescence indices. Partial least squares - SEM: - a demo using FEF data to review terms and observe a basic model Testing iterations of the PLS_SEM FEF - multiple models in different combinations of indicator and latent variables. "],["addition-of-precipitation-and-runoff-data.html", "2 Addition of precipitation and runoff data", " 2 Addition of precipitation and runoff data This script will eventually be moved to an earlier chapter in the workflow once the data management and collection chapters are added to this book. For the time being, this generates a .csv that is imported to chapter 4. Inputs used in this script are inputsim_dh1_year and fool_input_year csvs that are generated from snowmelt models. Scripts are found in models_analysis/WECOH_deadhorse/1_precip/scripts/5_SNOTEL.SWE.Model.Deadhorse.LK.Rmd and a similar path for the Fool Creek WECOH workflow. Runoff and snowmelt are modeled for both, one model for each side of the East S. Louis catchament. Therefore Deadhorse estimations are also applied to Lexen in the PLS analysis. ## Warning: Removed 20 rows containing missing values or values outside the scale range (`geom_point()`). This is a summary of the precip data added to the PLS test iteration workflow. Blue represents the snowpack, orange is input. Each point represents the 3 day rolling average of each sample at the time it was collected. "],["correlations-plots.html", "3 Correlations plots:", " 3 Correlations plots: This script is an exploratory data visualization and testing multivariate procedures using the results of the 3-component PARAFAC model as response variables. PARAFAC methods: The corrected Excitation-emission matrix (EEM) were merged into a three-dimensional matrix and analyzed via the multivariate data analysis technique parallel factor analysis (PARAFAC) (Murphy et al. 2013). PARAFAC is a statistical tool used to decompose trilinear data arrays to identify and quantify independent underlying signals or ’components’ (Bro, 1997). DOM components were resolved using PARAFAC analysis and the package staRdom (Pucher et al. 2019) in statistical software R (version). The three-component model was validated through split-half analysis, which generates independent models from subsamples of the dataset (Murphy et al. 2014). The similarity between these models was assessed using Tucker’s congruence coefficient, with all values exceeding 0.98. This fit required removing 8 outliers, the 8 points with the greatest and inordinate leverage. Following validation, the 3 component PARAFAC model (table) was uploaded to the OpenFluor spectral database (Murphy et al, 2014) to identify spectrally similar components across other studies. Records in the database matching our components with a Tucker congruence exceeding (check 0.98) were reviewed to improve interpretation component sources and functions. The model is then exported to a dataframe containing the sum of loadings (intensities) for each sample, and the total and relative loadings for each component is merged with a summary dataframe that contains DOC concentration, as well as landcover, discharge and topographical data for each sample. "],["parafac-results-summary-figures.html", "3.1 PARAFAC results summary figures:", " 3.1 PARAFAC results summary figures: Emission-Excitation matrices for the 3 components identified by the 3 component PARAFAC model. Components 1 and 2 correspond with peaks for humic components, while component 3 is protein-like. "],["structure.html", "3.2 Structure:", " 3.2 Structure: There are a few ways we can group and explore this data. We can observe the PARAFAC components as fractions of the total fluorescence, i.e., the DOC ‘community’ structure. We can also review the DOC normalized fluorescence intensity of each component. This could help us better examine lability of DOC and how much fluorescence signal is produced per unit of carbon and differences in overall DOM reactivity (i.e., does a larger proportion of DOM fluoresce in some samples relative to others). This section will look first at distributions, correlations and PCA with relative loadings as the response variable, then follow a similar workflow with normalized DOC as the response. "],["relative-loadings.html", "3.3 1. Relative loadings", " 3.3 1. Relative loadings Relative loadings for each sample (i.e., loading for each component/total loading for the sample in the 3 component model). This tells us how much of each component contributes to the total fluorescence of that particular sample. 3.3.1 Box plots - Relative loadings Boxplots are visualizing relative loadings (component loading/total loading for the sample). These are not normalized by DOC concentration. This allows for comparisons between sites with varying DOC concentrations while avoiding the confounding effects of variations in DOC concentration. (i.e., regardless of the overall fluorescence intensity or DOC concentration) 3.3.1.1 Protein-like Figure 3.1: Figure. Box plots showing the relationships between the sample proportion of PARAFAC component 3 (protein-like) and watershed. dh,dhn and dhs = Deadhorse, fc = Fool Creek. Horizontal bars indicate sample median, asterisks indicate sample mean. Whiskers (vertical lines) extend to the most extreme data point which is no more than range times the interquartile range from the box 3.3.1.2 Humic Figure 3.2: Figure. Box plots showing the relationships between the sample proportion of PARAFAC component 1 (humic-type) and watershed. dh,dhn and dhs = Deadhorse, fc = Fool Creek Figure 3.3: Figure. Box plots showing the relationships between the sample proportion of PARAFAC component 2 (humic-type) and watershed. dh,dhn and dhs = Deadhorse, fc = Fool Creek 3.3.2 Distance Correlation matricies While Pearson’s correlation assumes linear relationships and normal distributions among variables, and Spearman assumptions are that data is monotonic (distribution consistently increases or decreases), most of our data for both response and explanatory variables are skewed or bimodal. For an initial exploration, we’ll start with a matrix of distance correlations. Distance correlation measures both linear and non-linear associations (unlike Pearson’s) using distances between observations. So we can also use it for continuous or categorical data, and skewed or other non-normal data. A drawback is that we can see dependence between variables, but we wont see the direction or type of dependence…so it might not be intuitive. Explanatory variable distributions: Figure 3.4: Figure. Plotting original distribution of response variables Figure 3.5: Figure. Plotting original distribution of explanatory variables Explanatory variable distributions: Figure 3.6: Figure. Plotting original distribution of explanatory variables Explanatory variable distributions: Figure 3.7: Figure. Plotting original distribution of explanatory variables 3.3.3 Pearson correlation matrices (scaled data) - Relative loadings 3.3.3.1 All samples with EEMs If matrices are in a purple gradient, then the plot includes all dates. If green, then the plot represents a subset of dates By looking at these, we are answering: “How does DOC composition shift with different watershed features?” 3.3.3.1.1 Landcover - all EEMS Figure 3.8: Figure. Combined plot showing the relationships between relative loadings of 3 PARAFAC components and landcover characteristics for all samples with EEMs data (July 2021- Oct 1, 2022). Color indicates direction and correlation value (Pearson’s). Asterisks indicate level of significance. This figure indicates that: - The humic fraction of the fluorescing DOM decreases with high percentages of tundra, and short canopy. - The humic fraction increases with increasing watershed coverage with forest canopy between 6 and 10m, and increasing landcover classified as cut or regenerating. - There are low but significant correlations between humic fractions and % catchment coverage by beetle-kill, meadows and old forest. Humic fractions increase slightly with % Beetle Kill and decrease with increased with increased meadow or old forest coverage. - Protein-like fractions of the fluorescing DOM decrease with high percentages of cut or regenerating forest, and canopy between 6 and 10m, - but increase with increased coverage by short canopy (&lt;5m) and Tundra. - Significant but weaker correlations indicate that protein-like fractions increase with increasing meadow and old forest coverage. 3.3.3.1.2 Topo and moisture - all EEMS Figure 3.9: Figure. Combined plot showing the relationships between relative loadings of 3 PARAFAC components and topographic or moisture characteristics for all samples with EEMs data (July 2021- Oct 1, 2022). Color indicates direction and correlation value (Pearson’s). Asterisks indicate level of significance. This figure indicates that: - humic fraction of the fluorescing DOM increase with increasing discharge, watershed area, the distance that allochthonous water travels before reaching the stream channel (dist to streams mean), and increased watershed moisture (as indicated by NDMI and TWI). - Humic fractions decrease with increasing watershed slope. - Protein-like fractions of the fluorescing DOM increase with increasing slope - and decrease with increasing Q, watershed area, increasing moisture indices, and increased mean distance to the stream channel. 3.3.3.1.3 Ions - all EEMS Figure 3.10: Figure. Combined plot showing the relationships between relative loadings of 3 PARAFAC components and DOC (mg/L), and ions (mg/L) for all samples with EEMs data (July 2021- Oct 1, 2022). Color indicates direction and correlation value (Pearson’s). Asterisks indicate level of significance. This figure indicates that: - humic fraction of the fluorescing DOM increase with increasing DOM, sodium, potassium (K) and fluoride (F) concentration). - Humic fractions decrease with increasing Ca+, Mg, and nitrate (NO3). - Protein-like fractions of the fluorescing DOM increase with increasing Ca+, Mg, and nitrate (NO3 - and decrease with increasing DOM, sodium, potassium (K) and fluoride (F) concentration). These correlations suggest that seasonal hydrological fluxes, rather than direct causation, drive changes in humic and protein fractions. Humic fractions are higher during periods of snowmelt and runoff compared to baseflow conditions. Snowmelt leads to elevated DOC as it is ‘flushed’ from the catchments. Correlations among ions and topographical or landcover features suggest co-correlation rather than causation…. Figure 3.11: Figure. Combined plot showing the relationships between relative loadings of 3 PARAFAC components and DOC (mg/L), and ions (mg/L) for all samples with EEMs data (July 2021- Oct 1, 2022). Color indicates direction and correlation value (Pearson’s). Asterisks indicate level of significance. 3.3.3.2 Summer subset 2022 (mid-June to mid July) 3.3.3.2.1 Landcover - summer 2022 Figure 3.12: Figure. Combined plot showing the relationships between relative loadings of 3 PARAFAC components and landcover characteristics for EEMs samples collected between June 10 to July 15, 2022, which includes a synoptic sampling. Color indicates direction and correlation value (Pearson’s). Asterisks indicate level of significance. This figure indicates that humic fraction of the fluorescing DOM increase with high percentages of tundra, and short canopy. Protein-like fractions of the fluorescing DOM increase with high percentages of cut or regenerating forest, and canopy between 6 and 10m. 3.3.3.2.2 Topography and Moisture Figure 3.13: Figure. Combined plot showing the relationships between relative loadings of 3 PARAFAC components and topographic or moisture characteristics for EEMs samples collected between June 10 to July 15, 2022, which includes a synoptic sampling. Color indicates direction and correlation value (Pearson’s). Asterisks indicate level of significance. This figure indicates that humic fraction of the fluorescing DOM increase with increasing discharge, the distance that allochthonous water travels before reaching the stream channel, and increased watershed moisture. Humic fractions decrease with watershed slope. Protein-like fractions of the fluorescing DOM increase with increasing slope and decrease with increasing Q, increasing moisture indices, and increased mean distance to the stream channel. 3.3.3.2.3 Ions - summer 2022 (mid-June to mid July) Figure 3.14: Figure. Combined plot showing the relationships between relative loadings of 3 PARAFAC components and DOC (mg/L), and ions (mg/L) EEMs samples collected between June 10 to July 15, 2022, which includes a synoptic sampling. Color indicates direction and correlation value (Pearson’s). Asterisks indicate level of significance. 3.3.4 Hydrograph - Fool Creek fractions with hydrograph Figure 3.15: Figure. relative loadings over time from Fool Creek outlet stream site only. Component 1 (humic) appears to increase with discharge while the fraction of Component 2 (humic) and Component 3 (protein-like) decrease during peak flow 3.3.5 Data preparation for multivariate statistical analysis - dimension reduction techniques So we have a lot of variables, both response and explanatory, so we’ll want to reduce the dimensionality and complexity of the data by using ordination methods that find best fitting components in multi-dimensional space. To decide on a method, we need to understand the relationships among our variables to decide if and how we want to deal with collinearity. In another workbook (.ipynb), we have seen collinearity between independent variables e.g. (slope and percent_Old.Forest). Multicollinearity can be a problem when fitting regression models as it makes it harder to interpret our coefficients. Using VIF (Variance Inflation Factor) we can explore collinearity between our independent variables. Interpreting the results: If the VIF is less than 5, multicollinearity is typically not a concern. If VIF is between 5 and 10, there may be some moderate multicollinearity. If VIF is greater than 10, multicollinearity is likely a serious issue, and you may want to consider removing or transforming variables. 3.3.5.1 Multicollinearity ## doc_mg.l na_mg.l nh4_mg.l K_mg.l ## 2.778940 3.687201 1.814268 3.200284 ## Mg_mg.l Ca_mg.l F_mg.l Cl_mg.l ## 5.168057 6.914420 1.915917 2.346317 ## NO3_mg.l area_km Qm3_s percent_1.5 ## 2.276190 5.403615 1.179126 1946.640744 ## percent_6.10 percent_11.15 slope_mean aspect_mean ## 1094.583005 593.202414 8.020170 6.822729 ## ndmi_raster_mean ndvi_raster_mean disttostreams_mean percent_Beetle.kill ## 12.756277 6.261219 4.602639 169.299285 ## percent_Old.Forest percent_cut.regenerating percent_Tundra distance.to.outlet ## 133.752341 39.423074 114.531399 10.082237 So given that we have a lot of mulitcollinearity, we can systematically remove variables that are non-essential or redundant: ## area_km slope_mean aspect_mean ndmi_raster_mean ## 1.835627 3.142438 4.079431 4.826514 ## ndvi_raster_mean disttostreams_mean percent_Beetle.kill percent_Old.Forest ## 3.599633 3.863261 84.406204 77.784414 ## percent_cut.regenerating percent_Tundra ## 22.503875 54.815622 But ultimately we have several variables contributing to a high VIF that are all important to our question. Therefore, we can try RDA and PCA as a dimension reduction technique, assuming we remove some of the most redundant variables. This should transform() the predictors into a smaller set of uncorrelated PCs (components) that still explain most of the variance. 3.3.5.2 Distributions and standardization To perform RDA and PCA, explanatory and response variables must be centered, standardized, transformed or normalized So these are all quantitative variables with different units and numerical ranges. Standardization transforms the variables so they have a mean of zero and a standard deviation of one. Let’s view the scaled distributions of standardized explanatory variables: Figure 3.16: Figure. Checking out the distribution of explanatory variables Now we will check the distributions of our response variables Figure 3.17: Figure. Checking out the distribution of response variables Our response variables are both right and left-skewed unimodal. We may need to make the data more symmetrical or approximately normal, This can ensure that they contribute equally to the analysis and RDA assumes linear relationships between variables. But these may be be close enough to approximately normal once they are standardized/z-scored (subtracts the mean and divides by the standard deviation for each variable): The scales are similar, the units are the same. Let’s move forward for now. Initial exploration with PCA Q² evaluates how well the model can predict unseen data based on the selected number of components. A higher Q² value indicates better predictive performance. Commonly, a Q² value greater than 0.095 is considered an acceptable threshold for a good predictive model. None of our components have Q² total greater than 0.095. This suggests that the PLS model may not have enough predictive power to explain the relationship between the response variables and explanatory variables, based on cross-validation. We know the relationships between individual response variables and explanatory variables are strong. PLS does not assume normality of the data, though scaling does seem to help the Q2. From the tutorial: “We now set a grid of values - thin at the start, but also restricted to a small number of genes for a parsimonious model, which we will test for each of the two components in the tune.spls() function, using the MAE criterion.” So, in simpler terms, I think this means this piece of code is tuning a partial least squares (PLS) regression model using cross-validation to find the best number of variables to include in the model. I want to include all response variables at this point, so this is adapted from the tutorial: ## Warning: &lt;anonymous&gt;: ... may be used in an incorrect context: ## spls(X = X, Y = Y, keepX = c(choice.keepX, keepX), keepY = c(choice.keepY, ## keepY), ncomp = comp, mode = mode, ...) ## Warning: &lt;anonymous&gt;: ... may be used in an incorrect context: ## spls(X = X, Y = Y, keepX = c(choice.keepX, keepX), keepY = c(choice.keepY, ## keepY), ncomp = comp, mode = mode, ...) ## Importance of components: ## PC1 PC2 PC3 PC4 PC5 PC6 PC7 PC8 PC9 PC10 ## Standard deviation 2.1860 1.4916 1.3046 1.1224 0.91363 0.68046 0.6681 0.36959 0.3305 0.18584 ## Proportion of Variance 0.3982 0.1854 0.1418 0.1050 0.06956 0.03859 0.0372 0.01138 0.0091 0.00288 ## Cumulative Proportion 0.3982 0.5836 0.7254 0.8304 0.89997 0.93856 0.9758 0.98714 0.9962 0.99911 ## PC11 PC12 ## Standard deviation 0.10306 8.348e-11 ## Proportion of Variance 0.00089 0.000e+00 ## Cumulative Proportion 1.00000 1.000e+00 ## Warning: The SGCCA algorithm did not converge 3.3.6 RDA (Redundancy Analysis) https://r.qcbs.ca/workshop10/book-en/redundancy-analysis.html Similar to PCA, but RDA is a constrained method that requries two datasets, one for response variables (e.g., PARAFAC component fractions) and one for explanatory variables (watershed characteristics) RDA identifies the portion of the variation in the response dataset that can be explained by the explanatory variables. So this tells us how much of the variability in the response variables is explained by the predictors. 3.3.6.1 All data - Workflow hidden except results for comparison to other subsets In the summary tables, the ‘Importance of components’ tells us the eigenvalues and their contributions to the variance for RDA components 1-3 and the PCs 1-3. ie. an eigenvalue represents the amount of variance explained by each component. Higher eigenvalues indicate that the component explains a larger portion of the total variance in the data. Then the Proportion Explained is the fraction of the total variance explained by each component. So at RDA1: Proportion Explained, we might see 0.32, which means RDA explains approximately 32% of the totalvariance. Then the cumulative Proportion tells us how much more of the variation is explianed as we add more components. Summary of ‘ALL SAMPLES’ RDA ## ## Call: ## rda(formula = standardized_resp ~ aspect_mean + twi_mean + ndvi_raster_mean + disttostreams_mean + percent_Beetle.kill + percent_Old.Forest + percent_cut.regenerating + area_km + Qm3_s, data = explanatory_standardized, na.action = na.exclude) ## ## Partitioning of variance: ## Inertia Proportion ## Total 2.999 1.0000 ## Constrained 1.095 0.3649 ## Unconstrained 1.905 0.6351 ## ## Eigenvalues, and their contribution to the variance ## ## Importance of components: ## RDA1 RDA2 PC1 PC2 ## Eigenvalue 1.0690 0.025593 1.599 0.3061 ## Proportion Explained 0.3564 0.008533 0.533 0.1020 ## Cumulative Proportion 0.3564 0.364941 0.898 1.0000 ## ## Accumulated constrained eigenvalues ## Importance of components: ## RDA1 RDA2 ## Eigenvalue 1.0690 0.02559 ## Proportion Explained 0.9766 0.02338 ## Cumulative Proportion 0.9766 1.00000 3.3.6.2 Streams only - workflow retained but hidden results shown for comparison among other analyses scaled: Summary of ‘STREAMS ONLY’ RDA ## ## Call: ## rda(formula = standardized_resp ~ aspect_mean + twi_mean + ndvi_raster_mean + disttostreams_mean + percent_Beetle.kill + percent_Old.Forest + percent_cut.regenerating + area_km + Qm3_s, data = explanatory_standardized, na.action = na.exclude) ## ## Partitioning of variance: ## Inertia Proportion ## Total 3.213 1.0000 ## Constrained 1.596 0.4967 ## Unconstrained 1.617 0.5033 ## ## Eigenvalues, and their contribution to the variance ## ## Importance of components: ## RDA1 RDA2 PC1 PC2 ## Eigenvalue 1.5686 0.027649 1.3662 0.2510 ## Proportion Explained 0.4881 0.008604 0.4252 0.0781 ## Cumulative Proportion 0.4881 0.496737 0.9219 1.0000 ## ## Accumulated constrained eigenvalues ## Importance of components: ## RDA1 RDA2 ## Eigenvalue 1.5686 0.02765 ## Proportion Explained 0.9827 0.01732 ## Cumulative Proportion 0.9827 1.00000 The Eigenvalues, and their contribution to the variance table provides a broader comparison of RDA and PCA results, while the Accumulated constrained eigenvalues shows the effectiveness of RDA components in explaining the variance in the context of the response variables. With both response and explanatory variables scaled as z-scores using scale(), we get an RDA that explains much of the constrained variance (97%). Let’s look at the coefficients associated with the variables in RDA1. They indicate the strength and direction of the relationship between each explanatory variable and the RDA1 component. 3.3.6.3 Summer synoptic: Shows entire workflow to derive best fitting RDA ## ## Call: ## rda(formula = standardized_resp ~ aspect_mean + twi_mean + ndvi_raster_mean + disttostreams_mean + percent_Beetle.kill + percent_Old.Forest + percent_cut.regenerating + area_km + Qm3_s, data = explanatory_standardized, na.action = na.exclude) ## ## Partitioning of variance: ## Inertia Proportion ## Total 3.0000 1.0000 ## Constrained 2.1704 0.7235 ## Unconstrained 0.8296 0.2765 ## ## Eigenvalues, and their contribution to the variance ## ## Importance of components: ## RDA1 RDA2 PC1 PC2 ## Eigenvalue 2.0177 0.15266 0.5835 0.24610 ## Proportion Explained 0.6726 0.05089 0.1945 0.08203 ## Cumulative Proportion 0.6726 0.72347 0.9180 1.00000 ## ## Accumulated constrained eigenvalues ## Importance of components: ## RDA1 RDA2 ## Eigenvalue 2.0177 0.15266 ## Proportion Explained 0.9297 0.07034 ## Cumulative Proportion 0.9297 1.00000 Significance testing: ## Permutation test for rda under reduced model ## Permutation: free ## Number of permutations: 999 ## ## Model: rda(formula = standardized_resp ~ aspect_mean + twi_mean + ndvi_raster_mean + disttostreams_mean + percent_Beetle.kill + percent_Old.Forest + percent_cut.regenerating + area_km + Qm3_s, data = explanatory_standardized, na.action = na.exclude) ## Df Variance F Pr(&gt;F) ## Model 9 2.17041 8.7208 0.001 *** ## Residual 30 0.82959 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 We can also test the significance of each canonical axis with by = “axis”. Recall that these axes represent the variation in explanatory variables in fewer dimensions. ## Permutation test for rda under reduced model ## Forward tests for axes ## Permutation: free ## Number of permutations: 999 ## ## Model: rda(formula = standardized_resp ~ aspect_mean + twi_mean + ndvi_raster_mean + disttostreams_mean + percent_Beetle.kill + percent_Old.Forest + percent_cut.regenerating + area_km + Qm3_s, data = explanatory_standardized, na.action = na.exclude) ## Df Variance F Pr(&gt;F) ## RDA1 1 2.01775 89.9920 0.001 *** ## RDA2 1 0.15266 6.8087 0.775 ## Residual 37 0.82959 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 or we can test the significance of each variable: ## Permutation test for rda under reduced model ## Terms added sequentially (first to last) ## Permutation: free ## Number of permutations: 999 ## ## Model: rda(formula = standardized_resp ~ aspect_mean + twi_mean + ndvi_raster_mean + disttostreams_mean + percent_Beetle.kill + percent_Old.Forest + percent_cut.regenerating + area_km + Qm3_s, data = explanatory_standardized, na.action = na.exclude) ## Df Variance F Pr(&gt;F) ## aspect_mean 1 0.09478 3.4274 0.062 . ## twi_mean 1 1.06887 38.6529 0.001 *** ## ndvi_raster_mean 1 0.20600 7.4496 0.012 * ## disttostreams_mean 1 0.43123 15.5942 0.001 *** ## percent_Beetle.kill 1 0.01110 0.4013 0.622 ## percent_Old.Forest 1 0.21447 7.7558 0.007 ** ## percent_cut.regenerating 1 0.00007 0.0025 0.995 ## area_km 1 0.10385 3.7556 0.056 . ## Qm3_s 1 0.04004 1.4478 0.215 ## Residual 30 0.82959 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 A variable may appear to have a strong influence or a high loading but not be statistically significant. This could be due to the variable being strongly correlated with the main gradient in the data but lacking statistical robustness (due to multicollinearity?). Variables like this might capture major trends in the data but don’t significantly improve the fit of the model when tested. This could mean that they are redundant or that the sample size is too small to detect their significance. Less influential but statistically significant means they account for a relatively small but non-random portion of the total variation. Might not be the primary drivers of variation, but they can be still be important to our understanding of secondary influences/trends. Figure 3.18: Figure. RDA1 loadings tell us the direction and strength between each explantory variable and the RDA1 component. Interpreting loadings for RDA1: Recall that there are three response variables here, each will have a loading that indicates its correlation with RDA1. Humic components 1 and 2 will have similar loadings (positive and negative) on RDA1, where the protein-like component will have the opposite loading. In the biplot, this should be visible as response variable vectors pointing in opposite directions. Figure 3.19: Figure. RDA biplot 3.3.7 PCA - All data Figure 3.20: Figure. ## Eigenvalue Variance_Explained Cumulative_Variance ## comp 1 4.342438811 39.47671647 39.47672 ## comp 2 1.886022429 17.14565845 56.62237 ## comp 3 1.581504209 14.37731099 70.99969 ## comp 4 0.898506305 8.16823914 79.16793 ## comp 5 0.764777292 6.95252084 86.12045 ## comp 6 0.661707308 6.01552098 92.13597 ## comp 7 0.433685986 3.94259987 96.07857 ## comp 8 0.225653909 2.05139917 98.12997 ## comp 9 0.149323029 1.35748208 99.48745 ## comp 10 0.052177182 0.47433802 99.96179 ## comp 11 0.004203539 0.03821399 100.00000 Although PC1 and PC2 explain a lot of the variance and most pubs focus on these, PC3 contributes a non-trivial amount of variance (14%). Together, the first three components explain the majority of the total variance, which (I think) is a better threshold for interpretation than &lt;50%. Let’s see. Visualize the PC1 loadings to see what our important drivers are: In this case, PC1 might represent a gradient related to DOC lability or stability across the landscape (e.g., a transition from microbial activity-driven DOC production in low slopes, southern aspects, more moist sub-watersheds, to more labile DOC driven by hydrological transport in older forests due to higher slopes, northern aspects and drier sub-watersheds. Subwatersheds with older forests tend to be on higher slopes, northern aspects, which receive less solar radiation (cooler, less microbial activity). These also retain snow for longer, sustaining humic inputs through the falling limb (we might see this in Lexen)? A lot more detail is applied to this below. …BUT, PCA is unsupervised and doesn’t directly consider the response variable. So how well does PC1 explain the variability of the first PARAFAC component (humic)?. Let’s look at PC1 in 2-D space by plotting it against our response variable to see how PC1 correlates with the sample fraction of Humic Component1. We can get a sense of the strength and direction of the relationship: Meh. Explore correlations between the first 3 PCs and the response variable: ## [,1] ## Dim.1 0.4673675 ## Dim.2 -0.1587496 ## Dim.3 0.1628407 Lets fit a linear model with the first few components as predictors: ## ## Call: ## lm(formula = relative_load_comp_1 ~ Dim.1 + Dim.2 + Dim.3, data = pca_scores) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.30789 -0.03662 0.01534 0.05326 0.31390 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 0.598080 0.005839 102.429 &lt; 2e-16 *** ## Dim.1 0.023549 0.002802 8.404 4.08e-15 *** ## Dim.2 -0.012137 0.004252 -2.855 0.00469 ** ## Dim.3 0.013596 0.004643 2.928 0.00374 ** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.09046 on 236 degrees of freedom ## Multiple R-squared: 0.2702, Adjusted R-squared: 0.2609 ## F-statistic: 29.12 on 3 and 236 DF, p-value: 4.698e-16 Conclusions Component1: The small coefficients, combined with the relatively low R-squared value, suggest that even though the relationships are significant, they might not be strong enough to drive substantial changes in relative_load_comp_1. I can increase the amount of variability by remove more variables from the PCA, but this still does not drastically improve the relationship between PC1 and PARAFAC component 1. Let’s look at Components 2 and 3 in the same fashion. It could be that Component 1 is driven by the fractions of 2 and 3…? COMPONENT 2 Explore correlations between the first 3 PCs and the response variable: ## [,1] ## Dim.1 0.46462289 ## Dim.2 -0.04673344 ## Dim.3 0.31533479 Lets fit a linear model with the first few components as predictors: ## ## Call: ## lm(formula = relative_load_comp_2 ~ Dim.1 + Dim.2 + Dim.3, data = pca_scores) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.122254 -0.014929 0.004666 0.024158 0.070329 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 0.185939 0.002188 84.991 &lt; 2e-16 *** ## Dim.1 0.009071 0.001050 8.640 8.62e-16 *** ## Dim.2 -0.001384 0.001593 -0.869 0.386 ## Dim.3 0.010201 0.001740 5.864 1.52e-08 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.03389 on 236 degrees of freedom ## Multiple R-squared: 0.3175, Adjusted R-squared: 0.3088 ## F-statistic: 36.59 on 3 and 236 DF, p-value: &lt; 2.2e-16 COMPONENT 3 Explore correlations between the first 3 PCs and the response variable: ## [,1] ## Dim.1 -0.4988821 ## Dim.2 0.1362872 ## Dim.3 -0.2196376 Lets fit a linear model with the first few components as predictors: ## ## Call: ## lm(formula = relative_load_comp_3 ~ Dim.1 + Dim.2 + Dim.3, data = pca_scores) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.29205 -0.06526 -0.02330 0.04171 0.39464 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 0.215981 0.007337 29.438 &lt; 2e-16 *** ## Dim.1 -0.032619 0.003521 -9.265 &lt; 2e-16 *** ## Dim.2 0.013522 0.005342 2.531 0.012 * ## Dim.3 -0.023797 0.005834 -4.079 6.19e-05 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.1137 on 236 degrees of freedom ## Multiple R-squared: 0.3157, Adjusted R-squared: 0.307 ## F-statistic: 36.29 on 3 and 236 DF, p-value: &lt; 2.2e-16 Not surprisingly, the coefficients are similar among humic components and while similar in absolute value, opposite for the protein-like component. Save this: Interpreting loadings for PC1: Negative Loadings Examples, clarifications: percent_Old.Forest as measured by a landcover classificaiton model (hand corrected Random Forest) percent_11.15 is the percent of the each subwatershed containing by forest btwn 11 and 15m tall as measured pixel counts of the canopy height model. These trees are ‘old’ but not the rare ancients found in the riparian valley. A negative loading in PC1 means that higher values of these variables are associated with lower values of the principal component (PC1), which ‘represents a particular combination of the variation explained by the dataset’ or in my words, a regression line that best fits the multidimensional space created by all of the variables. I think this means these are related to reduced Component1 fractions. Again, this is counter to Fegel results and the logic that the older forests would contain more recalcitrant sources of DOC. However, higher slopes and more tundra-covered areas also may negatively influence Component 1 humic fractions. This makes sense, as DOM is likely hydrologically transported faster in these conditions, with less time or material for microbial activity, transporting DOC while it is still labile. Positive Loadings: On the other hand, positive loadings mean that higher values of these variables contribute positively to PC1. Top examples, clarification: aspect higher aspect values (180 to 270) represent south and west aspects, 0-90 represent north and east. Previous studies that conclude that microbial decomposition of soil organic matter and enzyme activities associated with soil C, N, and P cycling increased with increasing temperature: Liu et al 2021 in Effects of natural vegetation restoration on DOM..and they cite: Min et al., 2019; Nazaries et al., 2015; Pang et al., 2015. disttostreams_mean is derived from a whitebox raster that calculates the downslope distance to the nearest downslope stream cell. This is assumed to give us a relative idea of the retention time of allochthonous water. Larger distances to the stream mean potentially more time for microbial activity to improve recalcitrance before DOM enters the stream channel. percent_cut.regenerating is the percent of subwatershed area covered by ‘cut’ plots. Thse are potentially areas of ‘newer’ forests, and in Deadhorse, many of these appear similar to meadows. We might expect a decreased humic component with regenerating forest as they can have lower litter production, shallow root systems, leading to decreased input of humic subtances (notes from a Tim meeting). However, we might be at an older stage of succession at this point (40+ years post harvest at this point). Roots are deeper, litter and deadwood has likely had time to accumulate in these plots. This can enhance complex, recalcitrant carbon compounds, like our humic Component1. percent_Beetle.kill Similar to above, beetle kill leaves the deadwood of old trees in place. We might expect these to be a source of recalcitrant carbon. TWI is arguably important in the fraction of humic components. Like distancetostreams, is likely an indication of the allochthonous water retention. In other words, increased water retention in areas with higher wetness indices, where DOM originating from surrounding soils (allochthonous DOM) can remain for extended periods may allow for greater microbial processing of DOM, leading to the accumulation of more recalcitrant, humic Components before the DOM is transported into the stream channel. "],["normalized-doc.html", "3.4 2. Normalized DOC", " 3.4 2. Normalized DOC As well as observing fractions of fluorescing DOC, we can normalize our total ‘loading’ or fluorescence by the DOC concentration. This could help us better examine lability of DOC and how much fluorescence signal is produced per unit of carbon and differences in overall DOM reactivity (i.e., does a larger proportion of DOM fluoresce in some samples relative to others). 3.4.1 Box plots - DOC normalized loadings Boxplots are visualizing DOC normalized loadings among watersheds Figure 3.21: Figure. Box plots showing the relationships the normalized fluorescence intensity and watershed. dh,dhn and dhs = Deadhorse, fc = Fool Creek. Horizontal bars indicate sample median, asterisks indicate sample mean. Whiskers (vertical lines) extend to the most extreme data point which is no more than range times the interquartile range from the box We can also explore normalized intensity, or the total fluorescence per unit of DOC of each PARAFAC component. Why do we care? Without normalization fluorescence intensity can be heaviliy influenced by DOC concentration. 3.4.1.1 Humic1 - or PARAFAC component 1 Figure 3.22: Figure. Box plots showing the relationships between the PARAFAC component 1 fluorescence intensity (humic-type) and watershed. dh,dhn and dhs = Deadhorse, fc = Fool Creek 3.4.1.2 Humic2 - or PARAFAC component 2 Figure 3.23: Figure. Box plots showing the relationships between the PARAFAC component 2 fluorescence intensity (humic-type) and watershed. dh,dhn and dhs = Deadhorse, fc = Fool Creek 3.4.1.3 Protein-like - or PARAFAC component 3 Figure 3.24: Figure. Box plots showing the relationships between the PARAFAC component 2 fluorescence intensity (humic-type) and watershed. dh,dhn and dhs = Deadhorse, fc = Fool Creek 3.4.2 Correlation matrices - Normalized loadings If matrices are in a purple gradient, then the plot includes all dates. If green, then the plot represents a subset of dates By looking at these, we are answering: “How does the actual concentration of a specific DOC component (humic, protein-like, etc.) change in relation to these watershed variables?” #### ALL EEMS ##### Landcover Figure 3.25: Figure. Combined plot showing the relationships between fluorescence intensity of 3 PARAFAC components and landcover characteristics for all samples with EEMs data (July 2021- Oct 1, 2022). Color indicates direction and correlation value (Pearson’s). Asterisks indicate level of significance. This figure indicates that: - The fluorescence intensity of humic DOM slightly decreases with high percentages of 6-10m canopy - The fluorescence intensity of humic DOM slightly increases with increasing watershed coverage of very tall canopy &gt;15m. Protein-like fluorescence intensity decreases with high percentages of cut or regenerating forest, and canopy between 6 and 10m, but increase with increased coverage by Tundra. Significant but weaker correlations indicate that protein-like fractions increase with increasing meadow and old forest coverage. Overall, these trends are similar to those seen when looking at fractions (rather than normalized intensities) but with lower correlations and less significance (greater variation) 3.4.2.0.1 Topo and moisture - all EEMS Figure 3.26: Figure. Combined plot showing the relationships between fluorescence intensity of 3 PARAFAC components and topographic or moisture characteristics for all samples with EEMs data (July 2021- Oct 1, 2022). Color indicates direction and correlation value (Pearson’s). Asterisks indicate level of significance. This figure indicates that: - the intensity of humic fluorescing DOM increases with increasing discharge. Humic fractions (DOC composition) show more relationships. Protein-like fluorescence intensity increases with increasing slope and distance from outlet. Protein-like fluorescence intensity decreases with increasing NDMI and TWI (moisture) and and increased mean distance to the stream channel. 3.4.2.0.2 Ions - all EEMS Figure 3.27: Figure. Combined plot showing the relationships between fluorescence intensity of 3 PARAFAC components and DOC (mg/L), and ions (mg/L) for all samples with EEMs data (July 2021- Oct 1, 2022). Color indicates direction and correlation value (Pearson’s). Asterisks indicate level of significance. This figure indicates that: - intensity of humic fluorescing DOM decreases with Potassium. - intensity of protein-like fluorescing DOM increase with increasing Ca+ and nitrate (NO3 - and the intensity of protein-like fluorescing DOM decreases withsodium, potassium (K) and fluoride (F) concentration)(same or similar resutls to fractions). 3.4.2.1 Summer subset 2022 (mid-June to mid July) 3.4.2.1.1 Landcover - summer 2022 Figure 3.28: Figure. Combined plot showing the relationships between fluorescence intensities of 3 PARAFAC components and landcover characteristics for EEMs samples collected between June 10 to July 15, 2022, which includes a synoptic sampling. Color indicates direction and correlation value (Pearson’s). Asterisks indicate level of significance. This figure indicates that humic fraction of the fluorescing DOM increase with high percentages of tundra, and short canopy. Protein-like fractions of the fluorescing DOM increase with high percentages of cut or regenerating forest, and canopy between 6 and 10m. Figure 3.29: Figure. Combined plot showing the relationships between relative loadings of 3 PARAFAC components and topographic or moisture characteristics for EEMs samples collected between June 10 to July 15, 2022, which includes a synoptic sampling. Color indicates direction and correlation value (Pearson’s). Asterisks indicate level of significance. This figure indicates that humic fraction of the fluorescing DOM increase with increasing discharge, the distance that allochthonous water travels before reaching the stream channel, and increased watershed moisture. Humic fractions decrease with watershed slope. Protein-like fractions of the fluorescing DOM increase with increasing slope and decrease with increasing Q, increasing moisture indices, and increased mean distance to the stream channel. 3.4.2.1.2 Ions - summer 2022 (mid-June to mid July) Figure 3.30: Figure. Combined plot showing the relationships between relative loadings of 3 PARAFAC components and DOC (mg/L), and ions (mg/L) EEMs samples collected between June 10 to July 15, 2022, which includes a synoptic sampling. Color indicates direction and correlation value (Pearson’s). Asterisks indicate level of significance. 3.4.3 Hydrograph - Fluorescence intensities in Fool creek with 2022 hydrograph Figure 3.31: Figure. Fluorescence intensities over time from Fool Creek outlet stream site only. Component 1 (humic) appears to increase with discharge while the fraction of Component 2 (humic) and Component 3 (protein-like) decrease during peak flow 3.4.4 PCA Figure 3.32: Figure. …BUT again, PCA is unsupervised and doesn’t directly consider the response variable. So how well does PC1 explain the variability of the first PARAFAC component (humic)?. Let’s look at PC1 in 2-D space by plotting it against our response variable to see how PC1 correlates with the sample fraction of Humic Component1. We can get a sense of the strength and direction of the relationship: Meh. Explore correlations between the first 3 PCs and the response variable: ## [,1] ## Dim.1 0.04106679 ## Dim.2 -0.01112259 ## Dim.3 0.15737747 Lets fit a linear model with the first few components as predictors: ## ## Call: ## lm(formula = norm_PARAF_c1 ~ Dim.1 + Dim.2 + Dim.3, data = pca_scores) ## ## Residuals: ## Min 1Q Median 3Q Max ## -8.301 -3.819 -1.435 1.692 29.909 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 8.05303 0.39914 20.176 &lt;2e-16 *** ## Dim.1 0.12248 0.19154 0.639 0.523 ## Dim.2 -0.05033 0.29064 -0.173 0.863 ## Dim.3 0.77774 0.31739 2.450 0.015 * ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 6.183 on 236 degrees of freedom ## Multiple R-squared: 0.02658, Adjusted R-squared: 0.0142 ## F-statistic: 2.148 on 3 and 236 DF, p-value: 0.09491 There is a significant and decent correlation with PC3: 3.4.5 RDA (Redundancy Analysis) -If explanatory variables must be centered, standardized, transformed or normalized We know from looking at distribuiton sin part 1 that our data is made up of quantitative variables with different units and numerical ranges. Standardization transforms the variables so they have a mean of zero and a standard deviation of one. Also, our response variables are right-skewed unimodal. We need to make the data more symmetrical or approximately normal, as RDA assumes linear relationships between variables. In the case of a right-skew, we can log transform to compress the long right tails and spread out lower values. Ok, now our responses are approximately normal. The scales are similar, the units are the same. I am not sure if we want to standardize/z-score these as well. This can ensure that they contribute equally to the analysis…lets try both and see if scaling makes a difference: scaled: ## Call: rda(formula = standardized_resp ~ aspect_mean + twi_mean + ndvi_raster_mean + ## disttostreams_mean + percent_Beetle.kill + percent_Old.Forest + percent_cut.regenerating + ## area_km + Qm3_s, data = explanatory_standardized, na.action = na.exclude) ## ## -- Model Summary -- ## ## Inertia Proportion Rank ## Total 3.1161 1.0000 ## Constrained 0.3609 0.1158 3 ## Unconstrained 2.7552 0.8842 3 ## ## Inertia is variance ## ## -- Note -- ## ## 20 observations deleted due to missingness ## ## -- Eigenvalues -- ## ## Eigenvalues for constrained axes: ## RDA1 RDA2 RDA3 ## 0.23129 0.12801 0.00165 ## ## Eigenvalues for unconstrained axes: ## PC1 PC2 PC3 ## 2.4113 0.3132 0.0307 Constrained variance (0.009048, 48.1%): This is the portion of the total variance in the response matrix explained by the explanatory variables (e.g., area, slope, NDVI, etc.). i.e., variables explain around 48% of the variation the PARAFAC component fractions. Unconstrained variance (0.009779, 51.9%): This is not explained by the predictors, so more than half of the variation is not explained by the model. This returns the note Some constraints or conditions were aliased because they were redundant. This can happen if terms are linearly dependent (collinear): ‘percent_Tundra’. -Similar to PCA, but it is a constrained method that requries two datasets, one for response variables (e.g., PARAFAC component fractions) and one for explanatory variables (watershed characteristics) RDA identifies the portion of the variation in the response dataset that can be explained by the explanatory variables. So this tells us how much of the variability in the response variables is explained by the predictors. ## Call: rda(formula = response_matrix ~ aspect_mean + twi_mean + ndvi_raster_mean + ## disttostreams_mean + percent_Beetle.kill + percent_Old.Forest + percent_cut.regenerating + ## area_km + Qm3_s, data = explanatory_matrix, na.action = na.exclude) ## ## -- Model Summary -- ## ## Inertia Proportion Rank ## Total 57.25590 1.00000 ## Constrained 5.60843 0.09795 3 ## Unconstrained 51.64747 0.90205 3 ## ## Inertia is variance ## ## -- Note -- ## ## 20 observations deleted due to missingness ## ## -- Eigenvalues -- ## ## Eigenvalues for constrained axes: ## RDA1 RDA2 RDA3 ## 3.696 1.907 0.006 ## ## Eigenvalues for unconstrained axes: ## PC1 PC2 PC3 ## 45.71 5.65 0.29 ## ## Call: ## rda(formula = response_matrix ~ aspect_mean + twi_mean + ndvi_raster_mean + disttostreams_mean + percent_Beetle.kill + percent_Old.Forest + percent_cut.regenerating + area_km + Qm3_s, data = explanatory_matrix, na.action = na.exclude) ## ## Partitioning of variance: ## Inertia Proportion ## Total 57.256 1.00000 ## Constrained 5.608 0.09795 ## Unconstrained 51.647 0.90205 ## ## Eigenvalues, and their contribution to the variance ## ## Importance of components: ## RDA1 RDA2 RDA3 PC1 PC2 PC3 ## Eigenvalue 3.69610 1.90662 5.708e-03 45.7081 5.65249 0.286916 ## Proportion Explained 0.06455 0.03330 9.969e-05 0.7983 0.09872 0.005011 ## Cumulative Proportion 0.06455 0.09785 9.795e-02 0.8963 0.99499 1.000000 ## ## Accumulated constrained eigenvalues ## Importance of components: ## RDA1 RDA2 RDA3 ## Eigenvalue 3.696 1.907 0.005708 ## Proportion Explained 0.659 0.340 0.001018 ## Cumulative Proportion 0.659 0.999 1.000000 Take home: PCA and RDA do not work well with multicollinearity, yet many of our variables covary, not because they are redundant, rather they are likely driving each other in a path (i.e. topography influences landcover which influences hydrology which influences DOM) "],["partial-least-squares-structural-equation-modeling-pls-sem.html", "4 Partial least squares – Structural Equation Modeling (PLS-SEM)", " 4 Partial least squares – Structural Equation Modeling (PLS-SEM) ‘PLS-SEM is capable of estimating very complex models. For example, if theoretical or conceptual assumptions support large models and sufficient data are available (i.e., meeting minimum sample size requirements), PLS-SEM can handle models of almost any size, including those with dozens of constructs and hundreds of indicator variables. As noted by Wold (1985), PLS-SEM is virtually without competition when path models with latent variables are complex in their structural relationships.’ – From Hair et al. 2021, An Introduction to SEM, pg 21 Most of this material is in summary of ‘An Introduction to Structural Equation Modeling’ by Hair et al. 2021 and from PLS Path Modeling with R. by Sanchez, G. 2013 SEMinR cran documentation at https://cran.r-project.org/web/packages/seminr/vignettes/SEMinR.html#reporting-results-of-a-bootstrapped-pls Case studies with similar analyses: Gao, X., Qiu, L., Huang, X., Wu, M., &amp; Cao, X. (2024). Monitoring grey water footprint and associated environmental controls in agricultural watershed. Environ Sci Pollut Res Int, 31(7), 11334-11348. https://www.ncbi.nlm.nih.gov/pubmed/38217819 Kumar Gorai, A., Tuluri, F., &amp; Tchounwou, P. B. (2015). Development of PLS–path model for understanding the role of precursors on ground level ozone concentration in Gulfport, Mississippi, USA. Atmospheric Pollution Research, 6(3), 389-397. 4.0.0.1 Why PLS-SEM? Works efficiently with (relatively) small sample sizes and complex models (more on this later). Does not assume normal distribution of data Works with formative and reflective models – but does not include circular relationships or loops "],["building-the-path-model.html", "4.1 Building the path model", " 4.1 Building the path model We will work first with an initial model so I can define terminology. We will cover structural theory after covering vocabulary 4.1.1 Path diagram of our model with tested indicators NOTE You may disagree with the arrangement of some of these indicators as they relate to the latent variables. That is as intended. We want to use this model to test the validity measures and demonstrate how they can guide a more logical path model. Latent variables are indirectly measured by means of variables which can be perfectly observed-measured. These types of variables are called manifest variables (MVs), also known as indicators. We use the information contained in indicators to obtain an approximate representation of the latent variable. Inner Model – Captures the relationships between latent variables (e.g., topography → landcover → runoff → DOC composition). The Outer Model Represents how the manifest variables/indicators load onto their corresponding latent variables. Here, we need to consider whether the lack of strong correlations within indicator sets on the “cause” side could limit the model’s explanatory power in capturing the full variance of latent variables like topography. There are checks to measure this. We will explore these after we run the model. Exogeneous latent variables only explain other constructs in the model. (e.g. Topography) Indicators of these be called formative Endogeneous latent variables are being explained in the model(Hydrological, landcover and DOM), according to Fig.1.1 in Hair et al. 2021, Indicators of these may be called reflexive variables Measurement theory specifies how the latent variables are measured. Since these are unobservable variables, we can measure them with ‘reflective ’measurements (i.e., direction of the arrows is from the indicator to the latent variable) or ‘formative’ measurements (arrow is from the latent variable to the measurement, indicating that the latent variable ‘causes’ the measurement). Structural theory shows how the latent variables are related to one another. When the path model is developed, the sequence is from left to right, Variables on the left side of the path are independent variables, and variables on the right side are dependent. Moreover, variables on the left are show a sequentially preceding and predicting the variables on the right. When variables are in the middle of the model, the serve as both independent and dependent variables in the structural model. Error terms are connected to the endogenous constructs and (reflectively) measured indicators. Error terms represent the unexplained variance when path models are estimated. i.e. the difference between the model’s in-sample prediction of a value and an observed value of an indicator or latent variable. In contrast, the formatively measured indicators (like those of topography) do not have error terms. And for DOM lability, the direction of the relationships between the latent variable and indicator are not relevant, as they are assumed to be equivalent. So, there is no error term associated with those indicators. Now that we have a path model, we need to test the theoretical relationships within that model. "],["data-managment-transformation.html", "4.2 Data managment / transformation", " 4.2 Data managment / transformation For this model demonstration, our EEMs dataset has been filtered to ‘stream’ samples only (no wells) (n= 91) The selection process for these variables includes review of the specific response variable, and the correlations of that variable with the explanatory variables found in combine_PARAFAC_w_ws, part 1.B.ii. 1. More on size: - A.10x rule: sample size should be – to 10x the number if independent variables (number of arrows pointing to a a latent variable) (Barclay, Higgins &amp; Thompson, 1995) - May still be too small, depending on complexity of model. - B. inverse square root method (a retrospective approach) -We take the path coefficient (a number showing the strength of the relationship between two variables) and divide it by its standard error (a measure of how much this coefficient might vary if the analysis is repeated). -Compare this ratio to a critical value that depends on the significance level we’re using (e.g., 1.96 for a 5% significance level in a two-tailed test). If the ratio is greater than the critical value, it suggests the relationship (path coefficient) is statistically significant. Hair 2021 pg 17 has equations for the desired significance level, e.g., \\[ \\text{Significance level} = 5\\%: \\quad n_{\\text{min}} &gt; \\left( \\frac{2.486}{p_{\\text{min}}} \\right)^2 \\] Where pmin is the value of the path coefficient with the minimum magnitude in the PLS path model. We can find that after we run the model with pls_model$path_coefs 2. Measurement scales measurements should be on a metric scale, ratio or interval scale. Could also be ordinal scales if datapoints are equidistant, or with binary data. Categorical data can be binary-coded, but may need additional attention when making interpretations. See Hair et al. 2022 PLS-SEM Primer if it comes to this 3. Missing data: All missing values need to be treated or removed. if less than 5% of values are missing per indicator, mean replacement or nearest neighbor will likely be used, depending on the nature of the missing data. We don’t have many of these. 4. Treatment of FEF data These are all quantitative variables with different units and numerical ranges. We first log-transformed discharge adding 1e-9 as a constant Transformations are common when dealing with variables that have non-normal distributions or large ranges in ecology. Justifying transformations based on the ecological characteristics of the data (e.g., discharge typically has an exponential distribution in headwater streams) enhances the credibility of the model. Using transformations helps to uncover meaningful ecological patterns that might be masked if extreme or skewed data overpowered the model. In practice, documenting and justifying each transformation based on ecological knowledge of the variables strengthens the model’s interpretability and credibility. This approach allows transformations to enhance the alignment between model structure and real-world processes. After transforming discharge, we standardized all columns in the dataframe. Standardization transforms the variables so they have a mean of zero and a standard deviation of one. Let’s view the scaled distributions of standardized explanatory variables: Figure 4.1: Figure. Checking out the distribution of explanatory variables Build the outer model or ‘constructs’ or latent variables simple_FEF_mm &lt;- constructs( composite(&quot;TOPO&quot;, multi_items(&quot;topo_&quot;, 1:4)), composite(&quot;HYDRO&quot;, single_item(&quot;hydro_1&quot;)), composite(&quot;LANDCOVER&quot;, multi_items(&quot;landcover_&quot;, 1:2)), composite(&quot;DOC&quot;, single_item(&#39;doc_1&#39;)) ) Now for the structural model: # Create structural model simple_FEF_sm &lt;- relationships( paths(from = c(&quot;TOPO&quot;), to = c(&quot;HYDRO&quot;, &quot;LANDCOVER&quot;, &quot;DOC&quot;)), paths(from = c(&quot;LANDCOVER&quot;), to = c(&quot;HYDRO&quot;, &quot;DOC&quot;)), paths(from = c(&quot;HYDRO&quot;), to = c(&quot;DOC&quot;))) # Note that neither a dataset nor a measurement model is specified in the structural model stage, so we can reuse the structural model object simple_sm across different datasets and measurement models. Model Estimation using the PLS-SEM algorithm. The algorithm needs to determine the scores of the constructs that are used as input for partial regression models within the path model. After the algorithm has calculated the construct scores, the scores are used to estimate each partial regression model in the path model. As a result, we obtain the estimates for all relationships in the measurement models (i.e., the indicator weights/loadings) and the structural model (i.e., the path coefficients). (more on pg 60 of Hair) summarize output "],["reporting-initial-results-and-evaluating-the-quality-of-reflective-measurement-models.html", "4.3 Reporting initial results and evaluating the quality of reflective measurement models", " 4.3 Reporting initial results and evaluating the quality of reflective measurement models estimated by PLS-SEM both in terms of reliability and validity. A plot of result reliability measures: plot(summary_simple_fef$reliability) Indicator reliability: First we want to know how much of each indicator’s variance is explained by the latent variable it is assigned to. ‘To compute an indicator’s explained variance, we need to square the indicator loading, which is the bivariate correlation between indicator and construct. As such, the indicator reliability indicates the communality of an indicator. Indicator loadings above 0.708 are recommended, since they indicate that the construct explains more than 50 percent of the indicator’s variance, thus providing acceptable indicator reliability.’ Hair et al. 2021 ## TOPO LANDCOVER HYDRO DOC ## topo_1 0.665 0.000 0.000 0.000 ## topo_2 0.755 0.000 0.000 0.000 ## topo_3 0.279 0.000 0.000 0.000 ## topo_4 0.846 0.000 0.000 0.000 ## hydro_1 0.000 0.000 1.000 0.000 ## landcover_1 0.000 0.807 0.000 0.000 ## landcover_2 0.000 0.783 0.000 0.000 ## doc_1 0.000 0.000 0.000 1.000 Take home: Our current topo_3 (subwatershed area in m^2) as a low reliability which can contribute to more measurement error to the model, which can weaken the model’s validity and interpretability. This means that less than 50% of it’s variance is explained by other ‘topography’ indicators, which makes sense. topo_3 represents watershed area may be a better variable to group with ‘hydrology’ rather than topograhy. We’ll test this along with other model variations in the next chapter. Then we want to check the ‘internal consistency reliability’ (rhoC). Internal consistency reliability is the extent to which indicators measuring the same construct are associated with each other. ’Higher values indicate higher levels of reliability. For example, reliability values between 0.60 and 0.70 are considered “acceptable in exploratory research,” whereas values between 0.70 and 0.90 range from “satisfactory to good.” Values above 0.90 (and definitely above 0.95) are problematic, since they indicate that the indicators are redundant, thereby reducing construct validity (Diamantopoulos, Sarstedt, Fuchs, Wilczynski, &amp; Kaiser, 2012).’Hair et al. 2021 Other sources indicate that 0.85 is a more conservative threshold value. ## alpha rhoC AVE rhoA ## TOPO 0.792 0.871 0.636 0.836 ## LANDCOVER 0.742 0.886 0.795 0.744 ## HYDRO 1.000 1.000 1.000 1.000 ## DOC 1.000 1.000 1.000 1.000 ## ## Alpha, rhoC, and rhoA should exceed 0.7 while AVE should exceed 0.5 Our rhoC values fall in the higher (not ideal) range of ‘satisfactory to good’ but our ‘problematic’ values are due to these latent values having single indicators, so they aren’t truly problematic. Convergent Validity: When we assess convergent validity, we’re checking how well each indicator represents the latent variable it’s supposed to measure. For convergent validity, we want to see if the indicators of the same latent variable are closely related rather than explaining different processes. This is where average variance extracted (AVE) comes in: AVE shows how much of the total variance in the indicators is actually explained by the construct. ## alpha rhoC AVE rhoA ## TOPO 0.792 0.871 0.636 0.836 ## LANDCOVER 0.742 0.886 0.795 0.744 ## HYDRO 1.000 1.000 1.000 1.000 ## DOC 1.000 1.000 1.000 1.000 ## ## Alpha, rhoC, and rhoA should exceed 0.7 while AVE should exceed 0.5 Here then we should not be surprised to see 1.00 for HYDRO and DOC AVE, as, up to this point, we have included only one indicator for these latent variables. However, for topo and landcover, we can be confident that we have chosen variables that are measuring the same thing as our AVE are high (over 0.5) Discriminant Validity Now we want to make sure that different latent variables in the model are distinct from each other, ie. they measure different concepts. One way to check this is by using the heterotrait–monotrait (HTMT) ratio. If the HTMT values are low (typically below 0.9), it indicates that the constructs are distinct and measure different concepts. ## TOPO LANDCOVER HYDRO DOC ## TOPO . . . . ## LANDCOVER 1.053 . . . ## HYDRO 0.486 0.501 . . ## DOC 0.584 0.554 0.305 . In this current configuration, topo and landcover may not be distinct. This is hardly surprising, landcover indicators are often directly and strongly correlated with many of the topographical variables. In this case, we are looking at the percentage of each subwatershed that is covered by ‘cut/regenerating’ forest. Many of these sites were on lower slopes (likely for ease of access), and in the case of Deadhorse, almost entirely on the southern aspect. Furthermore, ‘TWI’ or the total wetness index likely drives NDVI. A high correlation between topography and landcover in our SEM model isn’t necessarily problematic if it aligns with the underlying ecology of the study area Combining them into a single latent variable isn’t ideal for our research question, where we want to see if we can evaluate the impacts of land cover independent of topography. We may not have this issue if we look at other land cover types. Let’s come back to this to see if it needs addressing. We might be able to control for one construct in relation to the other, such as controlling for topography when examining landcover’s effect, to clarify their roles without removing one or the other. "],["bootstrapping-for-significance.html", "4.4 Bootstrapping for significance", " 4.4 Bootstrapping for significance PLS-SEM is a nonparametric method – thus, we need to perform bootstrapping to estimate standard errors and compute confidence intervals. Here we’ll use the bootstrap_model() function and specify the arguments seminr_model = corp_rep_simple_model, nboot = 1000, cores = NULL, seed = 123. In other words, we use 1,000 bootstrap subsamples. However, the final result computations should draw on 10,000 subsamples (Streukens &amp; Leroi-Werelds, 2016). These computations will take a while so we will do them after exploring other model configurations. "],["reporting-results-of-bootstrapped-pls.html", "4.5 Reporting results of bootstrapped PLS", " 4.5 Reporting results of bootstrapped PLS # Extract the bootstrapped HTMT sum_boot_fef &lt;- summary(boot_simple_fef, alpha= 0.10) sum_boot_fef$bootstrapped_HTMT ## Original Est. Bootstrap Mean Bootstrap SD T Stat. 5% CI 95% CI ## TOPO -&gt; LANDCOVER 1.053 1.051 0.123 8.566 0.823 1.217 ## TOPO -&gt; HYDRO 0.486 0.483 0.069 7.007 0.369 0.591 ## TOPO -&gt; DOC 0.584 0.581 0.082 7.126 0.429 0.702 ## LANDCOVER -&gt; HYDRO 0.501 0.496 0.121 4.136 0.280 0.682 ## LANDCOVER -&gt; DOC 0.554 0.551 0.112 4.966 0.349 0.721 ## HYDRO -&gt; DOC 0.305 0.302 0.112 2.715 0.112 0.487 This gives us the confidence intervals of the HTMT ratio. Again, our bootstrapped HTMT ratio indicating the high correlation between topography and landcover. The bootstrapping procedure yields t-values for the indicator weights (and other model parameters). We need to compare these t-values with the critical values from the standard normal distribution to decide whether the coefficients are significantly different from zero. Assuming a significance level of 5%, a t-value above 1.96 (two-tailed test) suggests that the indicator weight is statistically significant. Interpretation: As an example between Landcover and DOC B = -0.068: This is the standardized path coefficient between the two latent variables. A negative value (-0.068) indicates a weak negative relationship, meaning that as one variable increases slightly, the other decreases slightly, though the effect is minimal here. 95% CI [-0.332, 0.261]: This is the 95% confidence interval for the beta value, giving a range within which the true beta value is likely to fall, with 95% confidence. Since this interval includes zero (spanning from -0.332 to 0.261), the effect of landcover on DOC here could be statistically insignificant. So, in this current configuration, the standardized path coefficients between TOPO and LANDCOVER are significant and TOPO and DOC are significant (as our TOPO indicator variables increase, the fragment of DOC that is protein-like increases), but as the model is organized now, the effect of Landcover and hydrology are minimal and not significant. "],["testing-iterations-of-the-pls-sem-fef-model.html", "5 Testing iterations of the PLS-SEM FEF model", " 5 Testing iterations of the PLS-SEM FEF model For this model demonstration, our EEMs dataset has been filtered to ‘stream’ samples only (no wells) (n= 91) The selection process for these variables includes review of the specific response variable, and the correlations of that variable with the explanatory variables found in combine_PARAFAC_w_ws, part 1.B.ii. "],["model-1-flow-stage-classifier-as-a-latent-variable.-total-protein-like-component.html", "5.1 MODEL 1: Flow stage classifier as a latent variable. Total protein-like component ", " 5.1 MODEL 1: Flow stage classifier as a latent variable. Total protein-like component To include classifications in a PLS model, we generate a column in the dataset for each classificaiton, and a binomial indicators in each row. For example, of the stream stage at the time of sampling is just after peak flow, that sample will have a ‘1’ in the upper descending limb column, and a ‘0’ in all others. Potential classifications are ‘rising limb’, ‘upper descending limb’, ‘lower descending limb’ and baseflow. In the path model, lower_decreasing = stage_1, upper_decreasing = stage_2, increasing = stage_3. These classifications were developed by finding the date of peak flow for the respective year and stream, and the dates for the end and beginning of baseflow for each calendar year. Then the ‘midway’ point between peakflow and the first date of baseflow delineates upper and lower descending limbs. (find the name of this script, pretty sure its an .ipynb) Build the outer model or ‘constructs’ or latent variables Our indicators for each latent variable are as follows: Topo: –mean distance that allochthonous water has to travel to the stream channel –mean aspect in radians –mean subcatchment TWI Landcover: – % of subcatchment pixels with &gt;50% beetlekill – mean NDVI Hydro: –log discharge/m2 DOM: – sample fluorescence of protein-like component simple_FEF_mm &lt;- constructs( composite(&quot;TOPO&quot;, multi_items(&quot;topo_&quot;, 1:3)), composite(&quot;HYDRO&quot;, single_item(&quot;hydro_1&quot;)), composite(&quot;LANDCOVER&quot;, multi_items(&quot;landcover_&quot;, 1:2)), composite(&quot;DOM&quot;, single_item(&#39;dom_1&#39;)), composite(&quot;STAGE&quot;, multi_items(&quot;stage_&quot;, 1:4)) ) Now for the structural model: # Create structural model simple_FEF_sm &lt;- relationships( paths(from = c(&quot;TOPO&quot;), to = c(&quot;HYDRO&quot;, &quot;LANDCOVER&quot;, &quot;DOM&quot;)), paths(from = c(&quot;LANDCOVER&quot;), to = c(&quot;HYDRO&quot;, &quot;DOM&quot;)), paths(from = c(&quot;HYDRO&quot;), to = c(&quot;DOM&quot;)), paths(from = c(&quot;STAGE&quot;), to = c(&quot;HYDRO&quot;, &quot;DOM&quot;)) ) # Note that neither a dataset nor a measurement model is specified in the structural model stage, so we can reuse the structural model object simple_sm across different datasets and measurement models. Model Estimation using the PLS-SEM algorithm. See demo for more info. Output summary Recall that path coefficients indicate the relationship between the two latent variables and we generally want reliability indicators to be high. e.g., rhoC represents internal consistency reliability, which is the extent to which indicators measuring the same construct are associated with each other. values over 0.95 can indicate redundancy, but values over 0.7 are preferred. ## Warning in summary.lm(independents_regr): essentially perfect fit: summary may be unreliable ## ## Results from package seminr (2.3.4) ## ## Path Coefficients: ## HYDRO LANDCOVER DOM ## R^2 0.282 0.576 0.335 ## AdjR^2 0.258 0.571 0.304 ## TOPO 0.139 0.759 0.004 ## LANDCOVER -0.559 . -0.142 ## HYDRO . . -0.209 ## STAGE 0.258 . 0.603 ## ## Reliability: ## alpha rhoC AVE rhoA ## TOPO 0.907 0.940 0.839 0.960 ## LANDCOVER 0.865 0.936 0.880 0.875 ## HYDRO 1.000 1.000 1.000 1.000 ## STAGE -21.902 0.067 0.315 0.353 ## DOM 1.000 1.000 1.000 1.000 ## ## Alpha, rhoC, and rhoA should exceed 0.7 while AVE should exceed 0.5 A plot of result reliability measures: plot(summary_simple_fef$reliability) 5.1.1 Results of bootstrapped PLS # Extract the bootstrapped HTMT sum_boot_fef &lt;- summary(boot_simple_fef, alpha= 0.10) sum_boot_fef$bootstrapped_HTMT ## Original Est. Bootstrap Mean Bootstrap SD T Stat. 5% CI 95% CI ## TOPO -&gt; LANDCOVER 0.817 0.818 0.048 16.893 0.730 0.889 ## TOPO -&gt; HYDRO 0.265 0.269 0.081 3.279 0.135 0.394 ## TOPO -&gt; STAGE 0.138 0.210 0.071 1.931 0.103 0.330 ## TOPO -&gt; DOM 0.053 0.096 0.055 0.977 0.027 0.195 ## LANDCOVER -&gt; HYDRO 0.493 0.492 0.140 3.516 0.255 0.704 ## LANDCOVER -&gt; STAGE 0.141 0.215 0.078 1.818 0.099 0.352 ## LANDCOVER -&gt; DOM 0.048 0.078 0.050 0.975 0.020 0.173 ## HYDRO -&gt; STAGE 0.272 0.310 0.089 3.048 0.167 0.453 ## HYDRO -&gt; DOM 0.013 0.045 0.036 0.372 0.004 0.111 ## STAGE -&gt; DOM 0.473 0.487 0.079 6.009 0.347 0.611 This gives us the confidence intervals of the HTMT ratio. Interpretation: In this model, we are seeing -strong, significant relationships between topography and landcover, landcover and discharge (hydro), and flow stage (classified by hydrograph limb) and DOM, which is indicated by the total fluorescence of the protein-like component. - significant but weak relationships between flow stage and hydro, and hydro and DOM - weak and insignificant relationships between topography and DOM, topography and hydrology, landcover and DOM. This makes sense. The response variable in this analysis is the total amount of the protein-like component in the sample. We expect this to be positively correlated with the DOM concentration, which typically follows trends similar to flow/runoff. Let’s see if this same model tells a different story if we instead look at the relative fraction of protein in the sample. "],["model-2-include-a-flow-stage-classifier-as-a-latent-variable-where-response-is-protein-like-fraction-of-dom..html", "5.2 MODEL 2: include a flow stage classifier as a latent variable where response is protein-like fraction of DOM.", " 5.2 MODEL 2: include a flow stage classifier as a latent variable where response is protein-like fraction of DOM. Our indicators for each latent variable are as follows: Topo: –mean distance that allochthonous water has to travel to the stream channel –mean aspect in radians –mean subcatchment TWI Landcover: – % of subcatchment pixels with &gt;50% beetlekill – mean NDVI Hydro: –log discharge/m2 DOM: – fraction of protein-like component Output summary Recall that path coefficients indicate the relationship between the two latent variables and we generally want reliability indicators to be high. e.g., rhoC represents internal consistency reliability, which is the extent to which indicators measuring the same construct are associated with each other. values over 0.95 can indicate redundancy, but values over 0.7 are preferred. ## ## Results from package seminr (2.3.4) ## ## Path Coefficients: ## HYDRO LANDCOVER DOM ## R^2 0.311 0.585 0.368 ## AdjR^2 0.287 0.580 0.339 ## TOPO 0.132 0.765 -0.233 ## LANDCOVER -0.572 . -0.304 ## HYDRO . . 0.152 ## STAGE 0.311 . -0.175 ## ## Reliability: ## alpha rhoC AVE rhoA ## TOPO 0.907 0.939 0.837 0.979 ## LANDCOVER 0.865 0.936 0.880 0.884 ## HYDRO 1.000 1.000 1.000 1.000 ## STAGE -21.902 0.033 0.354 0.460 ## DOM 1.000 1.000 1.000 1.000 ## ## Alpha, rhoC, and rhoA should exceed 0.7 while AVE should exceed 0.5 A plot of result reliability measures: plot(summary_simple_fef$reliability) Interpretation: The response variable changes the details of the model. Now we see that stage has little effect on the fraction of protein-like DOM. We now see a weak but significant influence of both topography and landcover on the protein-like fraction. The relationships among the latent variables (topo-&gt; landcover-&gt; hydrology are similar to those in the previous model.) "],["model-3-remove-flow-as-a-latent-variable-where-response-is-protein-like-fraction-of-dom..html", "5.3 MODEL 3: Remove flow as a latent variable where response is protein-like fraction of DOM.", " 5.3 MODEL 3: Remove flow as a latent variable where response is protein-like fraction of DOM. Try adding other indicators to hydrology variable Our indicators for each latent variable are as follows: Topo: –mean distance that allochthonous water has to travel to the stream channel –mean aspect in radians –mean subcatchment TWI Landcover: – % of subcatchment pixels with &gt;50% beetlekill – mean NDVI Hydro: –log discharge/m2 –input.mm (snowmelt and precip) DOM: – fraction of protein-like component Output summary Recall that path coefficients indicate the relationship between the two latent variables and we generally want reliability indicators to be high. e.g., rhoC represents internal consistency reliability, which is the extent to which indicators measuring the same construct are associated with each other. values over 0.95 can indicate redundancy, but values over 0.7 are preferred. ## ## Results from package seminr (2.3.4) ## ## Path Coefficients: ## HYDRO LANDCOVER DOM ## R^2 0.214 0.585 0.341 ## AdjR^2 0.197 0.580 0.319 ## TOPO 0.153 0.765 -0.234 ## LANDCOVER -0.569 . -0.345 ## HYDRO . . 0.083 ## ## Reliability: ## alpha rhoC AVE rhoA ## TOPO 0.907 0.939 0.837 0.979 ## LANDCOVER 0.865 0.936 0.880 0.884 ## HYDRO 1.000 1.000 1.000 1.000 ## DOM 1.000 1.000 1.000 1.000 ## ## Alpha, rhoC, and rhoA should exceed 0.7 while AVE should exceed 0.5 A plot of result reliability measures: plot(summary_simple_fef$reliability) 5.3.1 Results of bootstrapped PLS # Extract the bootstrapped HTMT sum_boot_fef &lt;- summary(boot_simple_fef, alpha= 0.10) sum_boot_fef$bootstrapped_HTMT ## Original Est. Bootstrap Mean Bootstrap SD T Stat. 5% CI 95% CI ## TOPO -&gt; LANDCOVER 0.817 0.818 0.048 16.880 0.730 0.889 ## TOPO -&gt; HYDRO 0.265 0.269 0.081 3.282 0.136 0.394 ## TOPO -&gt; DOM 0.508 0.508 0.077 6.582 0.362 0.619 ## LANDCOVER -&gt; HYDRO 0.493 0.492 0.140 3.519 0.255 0.704 ## LANDCOVER -&gt; DOM 0.597 0.595 0.088 6.806 0.438 0.721 ## HYDRO -&gt; DOM 0.305 0.304 0.111 2.752 0.109 0.483 This gives us the confidence intervals of the HTMT ratio. Interpretation: In the above workflow, I tried a few combinations of ‘hydrological’ indicators like input.mm, snowpack.mm, standardized them by watershed area, tried log transformations, (some examples saved in an ‘iteration_results.doc in this working directory). Ultimately, the additional indicators did not exhibit sufficent intercorrelation to capture the underlying construct of ’hydrology’. So they do not enchance the latent variables predictive power in relation to DOM, or even the other latent variables. Therefore, moving forward, the ‘hydrology’ latent variable will only contain ‘discharge’ as an indicator. "],["model-4-remove-hydrology-altogether-as-a-latent-variable-where-response-is-protein-like-fraction-of-dom..html", "5.4 MODEL 4: Remove hydrology altogether as a latent variable where response is protein-like fraction of DOM.", " 5.4 MODEL 4: Remove hydrology altogether as a latent variable where response is protein-like fraction of DOM. Our indicators for each latent variable are as follows: Topo: –mean distance that allochthonous water has to travel to the stream channel –mean aspect in radians –mean subcatchment TWI Landcover: – % of subcatchment pixels with &gt;50% beetlekill – mean NDVI DOM: – fraction of protein-like component Output summary Recall that path coefficients indicate the relationship between the two latent variables and we generally want reliability indicators to be high. e.g., rhoC represents internal consistency reliability, which is the extent to which indicators measuring the same construct are associated with each other. values over 0.95 can indicate redundancy, but values over 0.7 are preferred. A plot of result reliability measures: plot(summary_simple_fef$reliability) 5.4.1 Results of bootstrapped PLS # Extract the bootstrapped HTMT sum_boot_fef &lt;- summary(boot_simple_fef, alpha= 0.10) sum_boot_fef$bootstrapped_HTMT ## Original Est. Bootstrap Mean Bootstrap SD T Stat. 5% CI 95% CI ## TOPO -&gt; LANDCOVER 0.817 0.818 0.048 16.880 0.730 0.889 ## TOPO -&gt; DOM 0.508 0.508 0.077 6.582 0.362 0.619 ## LANDCOVER -&gt; DOM 0.597 0.595 0.088 6.806 0.438 0.721 This gives us the confidence intervals of the HTMT ratio. Interpretation: This model proposes that the effect of topography on DOM is indirect, working through landcover changes, without consideration of runoff/discharge. Topographic features influence the type and distribution of landcover, which in turn impacts the fraction of protein-like DOM. This might mean that areas with specific topographic attributes develop landcover that naturally regulates or limits the release of protein-like DOM into the ecosystem. Specifically in this model, topography influences the distribution of beetle kill (2003-2006) affected forests (Tony Vorster’s 2017 paper), where drier slopes (southern aspect) were more affected by the outbreak. After almost 20yrs, we would be expect that many of these killed trees to be some state of decay (advanced? find source) and therefore the breakdown of these complex carbons are now accessible for microbial processing, releasing more labile, protein-like compounds into the watershed. So more summarily, topography dictates vegetation patterns, which then influence soil organic matter, microbial activity, and nutrient leaching. It suggests that interventions aiming to influence DOM levels might benefit from managing landcover (at least in our FEF system, though we obviously can’t control topography). Let’s look at this model with different landcover types: "],["model-5-change-landcover-types-to-harvest-regeneration-from-beetlekill.html", "5.5 MODEL 5: Change landcover types to harvest regeneration from beetlekill", " 5.5 MODEL 5: Change landcover types to harvest regeneration from beetlekill response is protein-like fraction of DOM. Our indicators for each latent variable are as follows: Topo: –mean distance that allochthonous water has to travel to the stream channel –mean aspect in radians –mean subcatchment TWI Landcover: – % of subcatchment pixels with harvested/regenerating vegetation – mean NDVI DOM: – fraction of protein-like component of DOM Output summary Recall that path coefficients indicate the relationship between the two latent variables and we generally want reliability indicators to be high. e.g., rhoC represents internal consistency reliability, which is the extent to which indicators measuring the same construct are associated with each other. values over 0.95 can indicate redundancy, but values over 0.7 are preferred. ## ## Results from package seminr (2.3.4) ## ## Path Coefficients: ## LANDCOVER DOM ## R^2 0.612 0.278 ## AdjR^2 0.608 0.262 ## TOPO 0.783 -0.366 ## LANDCOVER . -0.189 ## ## Reliability: ## alpha rhoC AVE rhoA ## TOPO 0.907 0.940 0.840 0.951 ## LANDCOVER 0.742 0.885 0.794 0.756 ## DOM 1.000 1.000 1.000 1.000 ## ## Alpha, rhoC, and rhoA should exceed 0.7 while AVE should exceed 0.5 A plot of result reliability measures: plot(summary_simple_fef$reliability) 5.5.1 Results of bootstrapped PLS # Extract the bootstrapped HTMT sum_boot_fef &lt;- summary(boot_simple_fef, alpha= 0.10) sum_boot_fef$bootstrapped_HTMT ## Original Est. Bootstrap Mean Bootstrap SD T Stat. 5% CI 95% CI ## TOPO -&gt; LANDCOVER 0.916 0.921 0.101 9.060 0.726 1.055 ## TOPO -&gt; DOM 0.508 0.508 0.077 6.582 0.362 0.619 ## LANDCOVER -&gt; DOM 0.554 0.553 0.111 4.997 0.349 0.721 This gives us the confidence intervals of the HTMT ratio. Interpretation: By replacing beetle kill forest with regenerating harvested forest, we can observe that: – The relationship between landcover and DOM becomes weaker and insignificant (β = -0.189). This suggests that, unlike beetle kill areas, regenerating harvested forests do not have a strong influence on the protein-like fraction of DOM. –The direct path from topography to DOM becomes stronger (β = -0.366) and significant. This indicates that, in the absence of beetle kill forests, topographic factors have a more direct influence on DOM, possibly because they impact soil stability, water flow, or other landscape features that affect DOM transport and accumulation. This difference could imply that beetle kill forests have a strong influence on the protein-like DOM fraction compared to regenerating forests. Beetle kill areas might themselves be a source of protein-like DOM and/or alter soil and water conditions in ways that change relative component fractions. Regenerating forests, on the other hand, might retain organic material more effectively or simply don’t have the same impact on DOM dynamics as beetle kill areas, likely because of differences in vegetation structure, soil microbial communities, or organic matter decomposition rates. Maybe Hydrology will have a greater influence on the model if looking at regenerating landcover: "],["model-6-add-back-hydrology-as-a-latent-variable-landcover-regenerating-forest.html", "5.6 MODEL 6: Add back hydrology as a latent variable, landcover = regenerating forest", " 5.6 MODEL 6: Add back hydrology as a latent variable, landcover = regenerating forest Our indicators for each latent variable are as follows: Topo: –mean distance that allochthonous water has to travel to the stream channel –mean aspect in radians –mean subcatchment TWI Landcover: – % of subcatchment pixels with &gt;50% beetlekill – mean NDVI Hydro: –log discharge/m2 –input.mm (snowmelt and precip) DOM: – fraction of protein-like component Output summary Recall that path coefficients indicate the relationship between the two latent variables and we generally want reliability indicators to be high. e.g., rhoC represents internal consistency reliability, which is the extent to which indicators measuring the same construct are associated with each other. values over 0.95 can indicate redundancy, but values over 0.7 are preferred. ## ## Results from package seminr (2.3.4) ## ## Path Coefficients: ## HYDRO LANDCOVER DOM ## R^2 0.193 0.608 0.300 ## AdjR^2 0.174 0.604 0.276 ## TOPO 0.139 0.780 -0.393 ## LANDCOVER -0.539 . -0.107 ## HYDRO . . 0.149 ## ## Reliability: ## alpha rhoC AVE rhoA ## TOPO 0.907 0.939 0.838 0.968 ## LANDCOVER 0.742 0.886 0.795 0.743 ## HYDRO 1.000 1.000 1.000 1.000 ## DOM 1.000 1.000 1.000 1.000 ## ## Alpha, rhoC, and rhoA should exceed 0.7 while AVE should exceed 0.5 A plot of result reliability measures: plot(summary_simple_fef$reliability) 5.6.1 Results of bootstrapped PLS # Extract the bootstrapped HTMT sum_boot_fef &lt;- summary(boot_simple_fef, alpha= 0.10) sum_boot_fef$bootstrapped_HTMT ## Original Est. Bootstrap Mean Bootstrap SD T Stat. 5% CI 95% CI ## TOPO -&gt; LANDCOVER 0.916 0.921 0.101 9.060 0.726 1.055 ## TOPO -&gt; HYDRO 0.265 0.269 0.081 3.282 0.136 0.394 ## TOPO -&gt; DOM 0.508 0.508 0.077 6.582 0.362 0.619 ## LANDCOVER -&gt; HYDRO 0.501 0.499 0.124 4.034 0.271 0.684 ## LANDCOVER -&gt; DOM 0.554 0.553 0.111 4.997 0.349 0.721 ## HYDRO -&gt; DOM 0.305 0.304 0.111 2.752 0.109 0.483 This gives us the confidence intervals of the HTMT ratio. Interpretation: So adding the ‘hydro’ latent variable in a circumstance where landcover does not strongly influence DOM does not add any explanatory power to the model. Let’s remove hydro again and explore how these dynamics change if our response is a humic-like fraction instead of protein-like. "],["model-7-change-response-to-fraction-of-humic-dom.html", "5.7 MODEL 7: Change response to fraction of humic DOM", " 5.7 MODEL 7: Change response to fraction of humic DOM keeping regeneration forest for now, removing ‘hydro’ as a latent variable Our indicators for each latent variable are as follows: Topo: –mean distance that allochthonous water has to travel to the stream channel –mean aspect in radians –mean subcatchment TWI Landcover: – % of subcatchment pixels with harvested/regenerating vegetation – mean NDVI DOM: – fraction of humic component 1 Output summary Recall that path coefficients indicate the relationship between the two latent variables and we generally want reliability indicators to be high. e.g., rhoC represents internal consistency reliability, which is the extent to which indicators measuring the same construct are associated with each other. values over 0.95 can indicate redundancy, but values over 0.7 are preferred. ## ## Results from package seminr (2.3.4) ## ## Path Coefficients: ## LANDCOVER DOM ## R^2 0.612 0.221 ## AdjR^2 0.608 0.203 ## TOPO 0.782 0.367 ## LANDCOVER . 0.123 ## ## Reliability: ## alpha rhoC AVE rhoA ## TOPO 0.907 0.940 0.840 0.948 ## LANDCOVER 0.742 0.885 0.794 0.757 ## DOM 1.000 1.000 1.000 1.000 ## ## Alpha, rhoC, and rhoA should exceed 0.7 while AVE should exceed 0.5 A plot of result reliability measures: plot(summary_simple_fef$reliability) 5.7.1 Results of bootstrapped PLS # Extract the bootstrapped HTMT sum_boot_fef &lt;- summary(boot_simple_fef, alpha= 0.10) sum_boot_fef$bootstrapped_HTMT ## Original Est. Bootstrap Mean Bootstrap SD T Stat. 5% CI 95% CI ## TOPO -&gt; LANDCOVER 0.916 0.921 0.101 9.060 0.726 1.055 ## TOPO -&gt; DOM 0.458 0.458 0.085 5.367 0.298 0.590 ## LANDCOVER -&gt; DOM 0.479 0.479 0.121 3.960 0.255 0.669 This gives us the confidence intervals of the HTMT ratio. Interpretation: Changing the response does not significantly change the model from model 5. Let’s try a beetle kill model with this same response to see if our interpretation of model 5 changes: "],["model-8-change-response-to-fraction-of-humic-dom-with-beetlekill.html", "5.8 MODEL 8: Change response to fraction of humic DOM with Beetlekill %", " 5.8 MODEL 8: Change response to fraction of humic DOM with Beetlekill % Our indicators for each latent variable are as follows: Topo: –mean distance that allochthonous water has to travel to the stream channel –mean aspect in radians –mean subcatchment TWI Landcover: – % of subcatchment pixels with &gt;50% beetlekill – mean NDVI DOM: – fraction of humic component 1 Output summary Recall that path coefficients indicate the relationship between the two latent variables and we generally want reliability indicators to be high. e.g., rhoC represents internal consistency reliability, which is the extent to which indicators measuring the same construct are associated with each other. values over 0.95 can indicate redundancy, but values over 0.7 are preferred. ## ## Results from package seminr (2.3.4) ## ## Path Coefficients: ## LANDCOVER DOM ## R^2 0.588 0.275 ## AdjR^2 0.583 0.259 ## TOPO 0.767 0.182 ## LANDCOVER . 0.372 ## ## Reliability: ## alpha rhoC AVE rhoA ## TOPO 0.907 0.940 0.839 0.960 ## LANDCOVER 0.865 0.935 0.879 0.921 ## DOM 1.000 1.000 1.000 1.000 ## ## Alpha, rhoC, and rhoA should exceed 0.7 while AVE should exceed 0.5 A plot of result reliability measures: plot(summary_simple_fef$reliability) 5.8.1 Results of bootstrapped PLS # Extract the bootstrapped HTMT sum_boot_fef &lt;- summary(boot_simple_fef, alpha= 0.10) sum_boot_fef$bootstrapped_HTMT ## Original Est. Bootstrap Mean Bootstrap SD T Stat. 5% CI 95% CI ## TOPO -&gt; LANDCOVER 0.817 0.818 0.048 16.880 0.730 0.889 ## TOPO -&gt; DOM 0.458 0.458 0.085 5.367 0.298 0.590 ## LANDCOVER -&gt; DOM 0.538 0.537 0.101 5.312 0.362 0.683 This gives us the confidence intervals of the HTMT ratio. Interpretation: This model is similar to model 4, proposes that the effect of topography on DOM is indirect, working through landcover changes. Topographic features influence the type and distribution of landcover, which in turn impacts the fraction of protein-like DOM. The direction of the influence on humic DOC is opposite of that on the protein-like component. "],["model-9-tundra-influence-on-change-to-fraction-of-humic-dom.html", "5.9 MODEL 9: Tundra influence on change to fraction of humic DOM", " 5.9 MODEL 9: Tundra influence on change to fraction of humic DOM Our indicators for each latent variable are as follows: Topo: –mean distance that allochthonous water has to travel to the stream channel –mean aspect in radians –mean subcatchment TWI Landcover: – % of subcatchment pixels with Tundra – mean NDVI DOM: – fraction of protein-like component 3 Output summary Recall that path coefficients indicate the relationship between the two latent variables and we generally want reliability indicators to be high. e.g., rhoC represents internal consistency reliability, which is the extent to which indicators measuring the same construct are associated with each other. values over 0.95 can indicate redundancy, but values over 0.7 are preferred. ## ## Results from package seminr (2.3.4) ## ## Path Coefficients: ## LANDCOVER DOM ## R^2 0.713 0.262 ## AdjR^2 0.709 0.245 ## TOPO -0.844 -0.772 ## LANDCOVER . -0.350 ## ## Reliability: ## alpha rhoC AVE rhoA ## TOPO 0.907 0.942 0.845 0.919 ## LANDCOVER 0.565 0.739 0.634 0.797 ## DOM 1.000 1.000 1.000 1.000 ## ## Alpha, rhoC, and rhoA should exceed 0.7 while AVE should exceed 0.5 A plot of result reliability measures: plot(summary_simple_fef$reliability) 5.9.1 Results of bootstrapped PLS # Extract the bootstrapped HTMT sum_boot_fef &lt;- summary(boot_simple_fef, alpha= 0.10) sum_boot_fef$bootstrapped_HTMT ## Original Est. Bootstrap Mean Bootstrap SD T Stat. 5% CI 95% CI ## TOPO -&gt; LANDCOVER 0.985 0.983 0.057 17.338 0.885 1.060 ## TOPO -&gt; DOM 0.508 0.508 0.077 6.582 0.362 0.619 ## LANDCOVER -&gt; DOM 0.334 0.362 0.084 3.998 0.254 0.525 This gives us the confidence intervals of the HTMT ratio. Interpretation: "],["reporting-initial-results-and-evaluating-the-quality-of-our-favorite-model.html", "6 Reporting initial results and evaluating the quality of our favorite model", " 6 Reporting initial results and evaluating the quality of our favorite model Indicator reliability: First we want to know how much of each indicator’s variance is explained by the latent variable it is assigned to. The indicator loading is like a score showing how closely that piece of information is related to the concept it measures. It’s a number between 0 and 1, with numbers closer to 1 meaning a stronger connection. This tells us how much of the information (or variation) in the indicator is explained by the concept it is measuring. To find this, we take the indicator loading and square it. For example, if the indicator loading is 0.8, squaring it (0.8 × 0.8) gives 0.64, or 64%. This means 64% of the information in that indicator is explained by the concept it measures. ‘Indicator loadings above 0.708 are recommended, since they indicate that the construct explains more than 50 percent of the indicator’s variance, thus providing acceptable indicator reliability.’ Hair et al. 2021 ## TOPO LANDCOVER DOM ## topo_1 0.862 0.000 0.000 ## topo_2 0.943 0.000 0.000 ## topo_3 0.731 0.000 0.000 ## landcover_1 0.000 0.697 0.000 ## landcover_2 0.000 0.303 0.000 ## landcover_3 0.000 0.797 0.000 ## landcover_4 0.000 0.740 0.000 ## dom_1 0.000 0.000 1.000 Take home: Our current topo_3 (subwatershed area in m^2) as a low reliability which can contribute to more measurement error to the model, which can weaken the model’s validity and interpretability. This means that less than 50% of it’s variance is explained by other ‘topography’ indicators, which makes sense. This may be a better variable to group with ‘hydrology’. Then we want to check the ‘internal consistency reliability’ (rhoC). Internal consistency reliability is the extent to which indicators measuring the same construct are associated with each other. ’Higher values indicate higher levels of reliability. For example, reliability values between 0.60 and 0.70 are considered “acceptable in exploratory research,” whereas values between 0.70 and 0.90 range from “satisfactory to good.” Values above 0.90 (and definitely above 0.95) are problematic, since they indicate that the indicators are redundant, thereby reducing construct validity (Diamantopoulos, Sarstedt, Fuchs, Wilczynski, &amp; Kaiser, 2012).’Hair et al. 2021 Other sources indicate that 0.85 is a more conservative threshold value. ## alpha rhoC AVE rhoA ## TOPO 0.907 0.942 0.845 0.919 ## LANDCOVER 0.565 0.739 0.634 0.797 ## DOM 1.000 1.000 1.000 1.000 ## ## Alpha, rhoC, and rhoA should exceed 0.7 while AVE should exceed 0.5 Our rhoC values fall in the higher (not ideal) range of ‘satisfactory to good’ but our ‘problematic’ values are likely due to these latent values having single indicators. Convergent Validity When we assess convergent validity, we’re checking how well each indicator represents the latent variable it’s supposed to measure. For convergent validity, we want to see if the indicators of the same latent variable are closely related. This is where average variance extracted (AVE) comes in: AVE shows how much of the total variance in the indicators is actually explained by the construct. Here then we should not be surprised to see 1.00 for HYDRO and DOM AVE, as, up to this point, we have included only one indicator for these latent variables. However, for topo and landcover, we can be confident that we have chosen variables that are measuring the same thing as our AVE are high (over 0.5) Discriminant Validity Now we want to make sure that different latent variables in the model are distinct from each other, ie. they measure different concepts. One way to check this is by using the heterotrait–monotrait (HTMT) ratio. If the HTMT values are low (typically below 0.9), it indicates that the constructs are distinct and measure different concepts. Interpretation: In this current model configuration, topo and landcover may not be distinct. This is hardly surprising, landcover is directly correlated with many of the topographical variables. In this case, we are looking at the percentage of each subwatershed that is covered by ‘cut/regenerating’ forest. Many of these sites were on lower slopes (likely for ease of access), and in the case of Deadhorse, almost entirely on the southern aspect. Furthermore, ‘TWI’ or the total wetness index likely drives NDVI. A high correlation between topography and landcover in our SEM model isn’t necessarily problematic if it aligns with the underlying ecology of the study area Combining them into a single latent variable isn’t ideal for our research question, where we want to see if we can evaluate the impacts of land cover independent of topography. We may not have this issue if we look at other land cover types. Let’s come back to this to see if it needs addressing. We might be able to control for one construct in relation to the other, such as controlling for topography when examining landcover’s effect, to clarify their roles without removing one or the other. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
