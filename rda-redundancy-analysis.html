<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.5 RDA (Redundancy Analysis) | PLS-SEM FEF model exploration and iterations</title>
  <meta name="description" content="3.5 RDA (Redundancy Analysis) | PLS-SEM FEF model exploration and iterations" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="3.5 RDA (Redundancy Analysis) | PLS-SEM FEF model exploration and iterations" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.5 RDA (Redundancy Analysis) | PLS-SEM FEF model exploration and iterations" />
  
  
  

<meta name="author" content="Lauren Kremer" />


<meta name="date" content="2024-10-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="pca.html"/>
<link rel="next" href="partial-least-squares-structural-equation-modeling-pls-sem.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="assets/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="assets/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="assets/viz-1.8.2/viz.js"></script>
<link href="assets/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="assets/grViz-binding-1.0.11/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="about.html"><a href="about.html"><i class="fa fa-check"></i><b>1.1</b> About</a></li>
<li class="chapter" data-level="1.2" data-path="usage.html"><a href="usage.html"><i class="fa fa-check"></i><b>1.2</b> Usage</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="addition-of-precipitation-and-runoff-data.html"><a href="addition-of-precipitation-and-runoff-data.html"><i class="fa fa-check"></i><b>2</b> Addition of precipitation and runoff data</a></li>
<li class="chapter" data-level="3" data-path="correlations-plots.html"><a href="correlations-plots.html"><i class="fa fa-check"></i><b>3</b> Correlations plots:</a>
<ul>
<li class="chapter" data-level="3.1" data-path="parafac-results-summary-figures.html"><a href="parafac-results-summary-figures.html"><i class="fa fa-check"></i><b>3.1</b> PARAFAC results summary figures:</a></li>
<li class="chapter" data-level="3.2" data-path="structure.html"><a href="structure.html"><i class="fa fa-check"></i><b>3.2</b> Structure:</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="structure.html"><a href="structure.html#relative-loadings"><i class="fa fa-check"></i><b>3.2.1</b> 1. Relative loadings</a></li>
<li class="chapter" data-level="3.2.2" data-path="structure.html"><a href="structure.html#a.-box-plots---relative-loadings"><i class="fa fa-check"></i><b>3.2.2</b> 1.A. Box plots - Relative loadings</a></li>
<li class="chapter" data-level="3.2.3" data-path="structure.html"><a href="structure.html#b.-distance-correlation-matricies"><i class="fa fa-check"></i><b>3.2.3</b> 1.B. Distance Correlation matricies</a></li>
<li class="chapter" data-level="3.2.4" data-path="structure.html"><a href="structure.html#b.-pearson-correlation-matrices---relative-loadings"><i class="fa fa-check"></i><b>3.2.4</b> 1.B. Pearson correlation matrices - Relative loadings</a></li>
<li class="chapter" data-level="3.2.5" data-path="structure.html"><a href="structure.html#c.-hydrograph---fool-creek-fractions-with-hydrograph"><i class="fa fa-check"></i><b>3.2.5</b> 1.C. Hydrograph - Fool Creek fractions with hydrograph</a></li>
<li class="chapter" data-level="3.2.6" data-path="structure.html"><a href="structure.html#d.-data-preparation-for-multivariate-statistical-analysis---dimension-reduction-techniques"><i class="fa fa-check"></i><b>3.2.6</b> 1.D. Data preparation for multivariate statistical analysis - dimension reduction techniques</a></li>
<li class="chapter" data-level="3.2.7" data-path="structure.html"><a href="structure.html#e.-partial-least-squares"><i class="fa fa-check"></i><b>3.2.7</b> 1.E. Partial least squares</a></li>
<li class="chapter" data-level="3.2.8" data-path="structure.html"><a href="structure.html#e.-rda-redundancy-analysis"><i class="fa fa-check"></i><b>3.2.8</b> 1.E. RDA (Redundancy Analysis)</a></li>
<li class="chapter" data-level="3.2.9" data-path="structure.html"><a href="structure.html#f.-pca-all-data"><i class="fa fa-check"></i><b>3.2.9</b> 1.F. PCA All data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="normalized-doc.html"><a href="normalized-doc.html"><i class="fa fa-check"></i><b>3.3</b> Normalized DOC</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="normalized-doc.html"><a href="normalized-doc.html#box-plots---doc-normalized-loadings"><i class="fa fa-check"></i><b>3.3.1</b> Box plots - DOC normalized loadings</a></li>
<li class="chapter" data-level="3.3.2" data-path="normalized-doc.html"><a href="normalized-doc.html#correlation-matrices---normalized-loadings"><i class="fa fa-check"></i><b>3.3.2</b> Correlation matrices - Normalized loadings</a></li>
<li class="chapter" data-level="3.3.3" data-path="normalized-doc.html"><a href="normalized-doc.html#correlation---summer-subset-2022-mid-june-to-mid-july"><i class="fa fa-check"></i><b>3.3.3</b> Correlation - Summer subset 2022 (mid-June to mid July)</a></li>
<li class="chapter" data-level="3.3.4" data-path="normalized-doc.html"><a href="normalized-doc.html#hydrograph---fluorescence-intensities-in-fool-creek-with-2022-hydrograph"><i class="fa fa-check"></i><b>3.3.4</b> Hydrograph - Fluorescence intensities in Fool creek with 2022 hydrograph</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>3.4</b> PCA</a></li>
<li class="chapter" data-level="3.5" data-path="rda-redundancy-analysis.html"><a href="rda-redundancy-analysis.html"><i class="fa fa-check"></i><b>3.5</b> RDA (Redundancy Analysis)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="partial-least-squares-structural-equation-modeling-pls-sem.html"><a href="partial-least-squares-structural-equation-modeling-pls-sem.html"><i class="fa fa-check"></i><b>4</b> Partial least squares – Structural Equation Modeling (PLS-SEM)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="building-the-path-model.html"><a href="building-the-path-model.html"><i class="fa fa-check"></i><b>4.1</b> Building the path model</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="building-the-path-model.html"><a href="building-the-path-model.html#path-diagram-of-our-model-with-tested-indicators"><i class="fa fa-check"></i><b>4.1.1</b> Path diagram of our model with tested indicators</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-managment-transformation.html"><a href="data-managment-transformation.html"><i class="fa fa-check"></i><b>4.2</b> Data managment / transformation</a></li>
<li class="chapter" data-level="4.3" data-path="reporting-initial-results-and-evaluating-the-quality-of-reflective-measurement-models.html"><a href="reporting-initial-results-and-evaluating-the-quality-of-reflective-measurement-models.html"><i class="fa fa-check"></i><b>4.3</b> Reporting initial results and evaluating the quality of reflective measurement models</a></li>
<li class="chapter" data-level="4.4" data-path="bootstrapping-for-significance.html"><a href="bootstrapping-for-significance.html"><i class="fa fa-check"></i><b>4.4</b> Bootstrapping for significance</a></li>
<li class="chapter" data-level="4.5" data-path="reporting-resutls-of-bootstrapped-pls.html"><a href="reporting-resutls-of-bootstrapped-pls.html"><i class="fa fa-check"></i><b>4.5</b> Reporting resutls of bootstrapped PLS</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="testing-iterations-of-the-pls-sem-fef-model.html"><a href="testing-iterations-of-the-pls-sem-fef-model.html"><i class="fa fa-check"></i><b>5</b> Testing iterations of the PLS-SEM FEF model</a>
<ul>
<li class="chapter" data-level="5.1" data-path="model-1-flow-stage-classifier-as-a-latent-variable.-total-protein-like-component.html"><a href="model-1-flow-stage-classifier-as-a-latent-variable.-total-protein-like-component.html"><i class="fa fa-check"></i><b>5.1</b> MODEL 1: Flow stage classifier as a latent variable. Total protein-like component <br></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="model-1-flow-stage-classifier-as-a-latent-variable.-total-protein-like-component.html"><a href="model-1-flow-stage-classifier-as-a-latent-variable.-total-protein-like-component.html#results-of-bootstrapped-pls"><i class="fa fa-check"></i><b>5.1.1</b> Results of bootstrapped PLS</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="model-2-include-a-flow-stage-classifier-as-a-latent-variable-where-response-is-protein-like-fraction-of-dom..html"><a href="model-2-include-a-flow-stage-classifier-as-a-latent-variable-where-response-is-protein-like-fraction-of-dom..html"><i class="fa fa-check"></i><b>5.2</b> MODEL 2: include a flow stage classifier as a latent variable where response is protein-like fraction of DOM.</a></li>
<li class="chapter" data-level="5.3" data-path="model-3-remove-flow-as-a-latent-variable-where-response-is-protein-like-fraction-of-dom..html"><a href="model-3-remove-flow-as-a-latent-variable-where-response-is-protein-like-fraction-of-dom..html"><i class="fa fa-check"></i><b>5.3</b> MODEL 3: Remove flow as a latent variable where response is protein-like fraction of DOM.</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="model-3-remove-flow-as-a-latent-variable-where-response-is-protein-like-fraction-of-dom..html"><a href="model-3-remove-flow-as-a-latent-variable-where-response-is-protein-like-fraction-of-dom..html#results-of-bootstrapped-pls-1"><i class="fa fa-check"></i><b>5.3.1</b> Results of bootstrapped PLS</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="model-4-remove-hydrology-altogether-as-a-latent-variable-where-response-is-protein-like-fraction-of-dom..html"><a href="model-4-remove-hydrology-altogether-as-a-latent-variable-where-response-is-protein-like-fraction-of-dom..html"><i class="fa fa-check"></i><b>5.4</b> MODEL 4: Remove hydrology altogether as a latent variable where response is protein-like fraction of DOM.</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="model-4-remove-hydrology-altogether-as-a-latent-variable-where-response-is-protein-like-fraction-of-dom..html"><a href="model-4-remove-hydrology-altogether-as-a-latent-variable-where-response-is-protein-like-fraction-of-dom..html#results-of-bootstrapped-pls-2"><i class="fa fa-check"></i><b>5.4.1</b> Results of bootstrapped PLS</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="model-5-change-landcover-types-to-harvest-regeneration-from-beetlekill.html"><a href="model-5-change-landcover-types-to-harvest-regeneration-from-beetlekill.html"><i class="fa fa-check"></i><b>5.5</b> MODEL 5: Change landcover types to harvest regeneration from beetlekill</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="model-5-change-landcover-types-to-harvest-regeneration-from-beetlekill.html"><a href="model-5-change-landcover-types-to-harvest-regeneration-from-beetlekill.html#results-of-bootstrapped-pls-3"><i class="fa fa-check"></i><b>5.5.1</b> Results of bootstrapped PLS</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="model-6-add-back-hydrology-as-a-latent-variable-landcover-regenerating-forest.html"><a href="model-6-add-back-hydrology-as-a-latent-variable-landcover-regenerating-forest.html"><i class="fa fa-check"></i><b>5.6</b> MODEL 6: Add back hydrology as a latent variable, landcover = regenerating forest</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="model-6-add-back-hydrology-as-a-latent-variable-landcover-regenerating-forest.html"><a href="model-6-add-back-hydrology-as-a-latent-variable-landcover-regenerating-forest.html#results-of-bootstrapped-pls-4"><i class="fa fa-check"></i><b>5.6.1</b> Results of bootstrapped PLS</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="model-7-change-response-to-fraction-of-humic-dom.html"><a href="model-7-change-response-to-fraction-of-humic-dom.html"><i class="fa fa-check"></i><b>5.7</b> MODEL 7: Change response to fraction of humic DOM</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="model-7-change-response-to-fraction-of-humic-dom.html"><a href="model-7-change-response-to-fraction-of-humic-dom.html#results-of-bootstrapped-pls-5"><i class="fa fa-check"></i><b>5.7.1</b> Results of bootstrapped PLS</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="model-8-change-response-to-fraction-of-humic-dom-with-beetlekill.html"><a href="model-8-change-response-to-fraction-of-humic-dom-with-beetlekill.html"><i class="fa fa-check"></i><b>5.8</b> MODEL 8: Change response to fraction of humic DOM with Beetlekill %</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="model-8-change-response-to-fraction-of-humic-dom-with-beetlekill.html"><a href="model-8-change-response-to-fraction-of-humic-dom-with-beetlekill.html#results-of-bootstrapped-pls-6"><i class="fa fa-check"></i><b>5.8.1</b> Results of bootstrapped PLS</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="model-9-tundra-influence-on-change-to-fraction-of-humic-dom.html"><a href="model-9-tundra-influence-on-change-to-fraction-of-humic-dom.html"><i class="fa fa-check"></i><b>5.9</b> MODEL 9: Tundra influence on change to fraction of humic DOM</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="model-9-tundra-influence-on-change-to-fraction-of-humic-dom.html"><a href="model-9-tundra-influence-on-change-to-fraction-of-humic-dom.html#results-of-bootstrapped-pls-7"><i class="fa fa-check"></i><b>5.9.1</b> Results of bootstrapped PLS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="reporting-initial-results-and-evaluating-the-quality-of-our-favorite-model.html"><a href="reporting-initial-results-and-evaluating-the-quality-of-our-favorite-model.html"><i class="fa fa-check"></i><b>6</b> Reporting initial results and evaluating the quality of our favorite model</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PLS-SEM FEF model exploration and iterations</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rda-redundancy-analysis" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> RDA (Redundancy Analysis)<a href="rda-redundancy-analysis.html#rda-redundancy-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>-If explanatory variables must be centered, standardized, transformed or normalized</p>
<p>So these are all quantitative variables with different units and numerical ranges. Standardization transforms the variables so they have a mean of zero and a standard deviation of one.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="rda-redundancy-analysis.html#cb29-1" tabindex="-1"></a><span class="co"># Standardizing the environmental variables</span></span>
<span id="cb29-2"><a href="rda-redundancy-analysis.html#cb29-2" tabindex="-1"></a>explanatory_standardized <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(explanatory_matrix, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p>Let’s view the distributions of standardized response variables:</p>
<p>Our response variables are right-skewed unimodal. We need to make the data more symmetrical or approximately normal, as RDA assumes linear relationships between variables. In the case of a right-skew, we can log transform to compress the long right tails and spread out lower values.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="rda-redundancy-analysis.html#cb30-1" tabindex="-1"></a>transf_response <span class="ot">&lt;-</span> <span class="fu">log</span>(response_matrix <span class="sc">+</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="rda-redundancy-analysis.html#cb31-1" tabindex="-1"></a>response_long <span class="ot">&lt;-</span> transf_response <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="rda-redundancy-analysis.html#cb31-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;Variable&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb31-3"><a href="rda-redundancy-analysis.html#cb31-3" tabindex="-1"></a></span>
<span id="cb31-4"><a href="rda-redundancy-analysis.html#cb31-4" tabindex="-1"></a><span class="co"># Plot density plots for each variable</span></span>
<span id="cb31-5"><a href="rda-redundancy-analysis.html#cb31-5" tabindex="-1"></a><span class="fu">ggplot</span>(response_long, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">fill =</span> Variable)) <span class="sc">+</span></span>
<span id="cb31-6"><a href="rda-redundancy-analysis.html#cb31-6" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add transparency for overlapping densities</span></span>
<span id="cb31-7"><a href="rda-redundancy-analysis.html#cb31-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Variable, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Create separate panels per variable</span></span>
<span id="cb31-8"><a href="rda-redundancy-analysis.html#cb31-8" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb31-9"><a href="rda-redundancy-analysis.html#cb31-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Density Plots for Explanatory Variables&quot;</span>,</span>
<span id="cb31-10"><a href="rda-redundancy-analysis.html#cb31-10" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Value&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>)</span></code></pre></div>
<p><img src="PLS_rendered_book_files/figure-html/unnamed-chunk-117-1.png" width="672" />
Ok, these are approximately normal. The scales are similar, the units are the same. I am not sure if we want to standardize/z-score these as well. This can ensure that they contribute equally to the analysis…lets try both and see if scaling makes a difference:</p>
<p><strong>scaled:</strong></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="rda-redundancy-analysis.html#cb32-1" tabindex="-1"></a><span class="co"># Standardize the transformed response data</span></span>
<span id="cb32-2"><a href="rda-redundancy-analysis.html#cb32-2" tabindex="-1"></a>standardized_resp <span class="ot">&lt;-</span><span class="fu">scale</span>(transf_response)</span>
<span id="cb32-3"><a href="rda-redundancy-analysis.html#cb32-3" tabindex="-1"></a><span class="co"># the RDA model</span></span>
<span id="cb32-4"><a href="rda-redundancy-analysis.html#cb32-4" tabindex="-1"></a>myrda <span class="ot">&lt;-</span> <span class="fu">rda</span>(standardized_resp <span class="sc">~</span> ., <span class="at">data =</span> explanatory_standardized, <span class="at">na.action =</span> na.exclude)</span>
<span id="cb32-5"><a href="rda-redundancy-analysis.html#cb32-5" tabindex="-1"></a></span>
<span id="cb32-6"><a href="rda-redundancy-analysis.html#cb32-6" tabindex="-1"></a><span class="co"># Plot the RDA result</span></span>
<span id="cb32-7"><a href="rda-redundancy-analysis.html#cb32-7" tabindex="-1"></a><span class="fu">plot</span>(myrda)</span></code></pre></div>
<p><img src="PLS_rendered_book_files/figure-html/unnamed-chunk-118-1.png" width="672" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="rda-redundancy-analysis.html#cb33-1" tabindex="-1"></a><span class="co"># Summarize the RDA result</span></span>
<span id="cb33-2"><a href="rda-redundancy-analysis.html#cb33-2" tabindex="-1"></a><span class="co">#summary(myrda)</span></span>
<span id="cb33-3"><a href="rda-redundancy-analysis.html#cb33-3" tabindex="-1"></a><span class="fu">print</span>(myrda)</span></code></pre></div>
<pre><code>## Call: rda(formula = standardized_resp ~ aspect_mean + twi_mean + ndvi_raster_mean +
## disttostreams_mean + percent_Beetle.kill + percent_Old.Forest + percent_cut.regenerating +
## area_km + Qm3_s, data = explanatory_standardized, na.action = na.exclude)
## 
## -- Model Summary --
## 
##               Inertia Proportion Rank
## Total          3.1161     1.0000     
## Constrained    0.3609     0.1158    3
## Unconstrained  2.7552     0.8842    3
## 
## Inertia is variance
## 
## -- Note --
## 
## 20 observations deleted due to missingness
## 
## -- Eigenvalues --
## 
## Eigenvalues for constrained axes:
##    RDA1    RDA2    RDA3 
## 0.23129 0.12801 0.00165 
## 
## Eigenvalues for unconstrained axes:
##    PC1    PC2    PC3 
## 2.4113 0.3132 0.0307</code></pre>
<p><u>Constrained variance (0.009048, 48.1%):</u> This is the portion of the total variance in the response matrix explained by the explanatory variables (e.g., area, slope, NDVI, etc.). i.e., variables explain around 48% of the variation the PARAFAC component fractions.</p>
<p><u>Unconstrained variance (0.009779, 51.9%):</u> This is <strong>not explained</strong> by the predictors, so less than half of the variation is not explained by the model.</p>
<p>This returns the note
Some constraints or conditions were aliased because they were redundant. This can happen if terms are linearly dependent (collinear): ‘percent_Tundra’.</p>
<p>-Similar to PCA, but it is a <u>constrained</u> method that requries two datasets, one for response variables (e.g., PARAFAC component fractions) and one for explanatory variables (watershed characteristics)</p>
<p>RDA identifies the portion of the variation in the response dataset that can be explained by the explanatory variables. So this tells us how much of the variability in the response variables is explained by the predictors.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="rda-redundancy-analysis.html#cb35-1" tabindex="-1"></a><span class="co"># the RDA model</span></span>
<span id="cb35-2"><a href="rda-redundancy-analysis.html#cb35-2" tabindex="-1"></a>myrda <span class="ot">&lt;-</span> <span class="fu">rda</span>(response_matrix <span class="sc">~</span> ., <span class="at">data =</span> explanatory_matrix, <span class="at">na.action =</span> na.exclude)</span>
<span id="cb35-3"><a href="rda-redundancy-analysis.html#cb35-3" tabindex="-1"></a></span>
<span id="cb35-4"><a href="rda-redundancy-analysis.html#cb35-4" tabindex="-1"></a><span class="co"># Plot the RDA result</span></span>
<span id="cb35-5"><a href="rda-redundancy-analysis.html#cb35-5" tabindex="-1"></a><span class="fu">plot</span>(myrda)</span></code></pre></div>
<p><img src="PLS_rendered_book_files/figure-html/unnamed-chunk-120-1.png" width="672" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="rda-redundancy-analysis.html#cb36-1" tabindex="-1"></a><span class="co"># Summarize the RDA result</span></span>
<span id="cb36-2"><a href="rda-redundancy-analysis.html#cb36-2" tabindex="-1"></a><span class="fu">print</span>(myrda)</span></code></pre></div>
<pre><code>## Call: rda(formula = response_matrix ~ aspect_mean + twi_mean + ndvi_raster_mean +
## disttostreams_mean + percent_Beetle.kill + percent_Old.Forest + percent_cut.regenerating +
## area_km + Qm3_s, data = explanatory_matrix, na.action = na.exclude)
## 
## -- Model Summary --
## 
##                Inertia Proportion Rank
## Total         57.25590    1.00000     
## Constrained    5.60843    0.09795    3
## Unconstrained 51.64747    0.90205    3
## 
## Inertia is variance
## 
## -- Note --
## 
## 20 observations deleted due to missingness
## 
## -- Eigenvalues --
## 
## Eigenvalues for constrained axes:
##  RDA1  RDA2  RDA3 
## 3.696 1.907 0.006 
## 
## Eigenvalues for unconstrained axes:
##   PC1   PC2   PC3 
## 45.71  5.65  0.29</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="rda-redundancy-analysis.html#cb38-1" tabindex="-1"></a><span class="fu">summary</span>(myrda)</span></code></pre></div>
<pre><code>## 
## Call:
## rda(formula = response_matrix ~ aspect_mean + twi_mean + ndvi_raster_mean +      disttostreams_mean + percent_Beetle.kill + percent_Old.Forest +      percent_cut.regenerating + area_km + Qm3_s, data = explanatory_matrix,      na.action = na.exclude) 
## 
## Partitioning of variance:
##               Inertia Proportion
## Total          57.256    1.00000
## Constrained     5.608    0.09795
## Unconstrained  51.647    0.90205
## 
## Eigenvalues, and their contribution to the variance 
## 
## Importance of components:
##                          RDA1    RDA2      RDA3     PC1     PC2      PC3
## Eigenvalue            3.69610 1.90662 5.708e-03 45.7081 5.65249 0.286916
## Proportion Explained  0.06455 0.03330 9.969e-05  0.7983 0.09872 0.005011
## Cumulative Proportion 0.06455 0.09785 9.795e-02  0.8963 0.99499 1.000000
## 
## Accumulated constrained eigenvalues
## Importance of components:
##                        RDA1  RDA2     RDA3
## Eigenvalue            3.696 1.907 0.005708
## Proportion Explained  0.659 0.340 0.001018
## Cumulative Proportion 0.659 0.999 1.000000</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="rda-redundancy-analysis.html#cb40-1" tabindex="-1"></a><span class="fu">plot</span>(myrda, <span class="at">scaling =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="PLS_rendered_book_files/figure-html/unnamed-chunk-123-1.png" width="672" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="rda-redundancy-analysis.html#cb41-1" tabindex="-1"></a><span class="co"># RDA result from the rda() function</span></span>
<span id="cb41-2"><a href="rda-redundancy-analysis.html#cb41-2" tabindex="-1"></a>rda_loadings <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(myrda<span class="sc">$</span>CCA<span class="sc">$</span>biplot)</span>
<span id="cb41-3"><a href="rda-redundancy-analysis.html#cb41-3" tabindex="-1"></a></span>
<span id="cb41-4"><a href="rda-redundancy-analysis.html#cb41-4" tabindex="-1"></a><span class="co"># Extract loadings for RDA1 and RDA2</span></span>
<span id="cb41-5"><a href="rda-redundancy-analysis.html#cb41-5" tabindex="-1"></a>rda1_loadings <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb41-6"><a href="rda-redundancy-analysis.html#cb41-6" tabindex="-1"></a>  <span class="at">variable =</span> <span class="fu">rownames</span>(rda_loadings),</span>
<span id="cb41-7"><a href="rda-redundancy-analysis.html#cb41-7" tabindex="-1"></a>  <span class="at">RDA1_Loading =</span> rda_loadings[, <span class="dv">1</span>]</span>
<span id="cb41-8"><a href="rda-redundancy-analysis.html#cb41-8" tabindex="-1"></a>)</span>
<span id="cb41-9"><a href="rda-redundancy-analysis.html#cb41-9" tabindex="-1"></a></span>
<span id="cb41-10"><a href="rda-redundancy-analysis.html#cb41-10" tabindex="-1"></a>rda2_loadings <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb41-11"><a href="rda-redundancy-analysis.html#cb41-11" tabindex="-1"></a>  <span class="at">variable =</span> <span class="fu">rownames</span>(rda_loadings),</span>
<span id="cb41-12"><a href="rda-redundancy-analysis.html#cb41-12" tabindex="-1"></a>  <span class="at">RDA2_Loading =</span> rda_loadings[, <span class="dv">2</span>]</span>
<span id="cb41-13"><a href="rda-redundancy-analysis.html#cb41-13" tabindex="-1"></a>)</span>
<span id="cb41-14"><a href="rda-redundancy-analysis.html#cb41-14" tabindex="-1"></a></span>
<span id="cb41-15"><a href="rda-redundancy-analysis.html#cb41-15" tabindex="-1"></a></span>
<span id="cb41-16"><a href="rda-redundancy-analysis.html#cb41-16" tabindex="-1"></a><span class="co"># Plot RDA1 loadings</span></span>
<span id="cb41-17"><a href="rda-redundancy-analysis.html#cb41-17" tabindex="-1"></a><span class="fu">ggplot</span>(rda1_loadings, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(variable, RDA1_Loading), <span class="at">y =</span> RDA1_Loading)) <span class="sc">+</span></span>
<span id="cb41-18"><a href="rda-redundancy-analysis.html#cb41-18" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-19"><a href="rda-redundancy-analysis.html#cb41-19" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb41-20"><a href="rda-redundancy-analysis.html#cb41-20" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb41-21"><a href="rda-redundancy-analysis.html#cb41-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;RDA1 Loadings&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Variables&quot;</span>, <span class="at">y =</span> <span class="st">&quot;RDA1 Loading&quot;</span>)</span></code></pre></div>
<p><img src="PLS_rendered_book_files/figure-html/unnamed-chunk-124-1.png" width="672" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="rda-redundancy-analysis.html#cb42-1" tabindex="-1"></a><span class="co"># Plot RDA2 loadings</span></span>
<span id="cb42-2"><a href="rda-redundancy-analysis.html#cb42-2" tabindex="-1"></a><span class="fu">ggplot</span>(rda2_loadings, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(variable, RDA2_Loading), <span class="at">y =</span> RDA2_Loading)) <span class="sc">+</span></span>
<span id="cb42-3"><a href="rda-redundancy-analysis.html#cb42-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;lightgreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb42-4"><a href="rda-redundancy-analysis.html#cb42-4" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb42-5"><a href="rda-redundancy-analysis.html#cb42-5" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-6"><a href="rda-redundancy-analysis.html#cb42-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;RDA2 Loadings&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Variables&quot;</span>, <span class="at">y =</span> <span class="st">&quot;RDA2 Loading&quot;</span>)</span></code></pre></div>
<p><img src="PLS_rendered_book_files/figure-html/unnamed-chunk-125-1.png" width="672" /></p>

</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="pca.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="partial-least-squares-structural-equation-modeling-pls-sem.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"depth": 1
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
